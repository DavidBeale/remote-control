(()=>{var $e=Object.defineProperty;var Jt=(t,e,n)=>e in t?$e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var s=(t,e)=>$e(t,"name",{value:e,configurable:!0});var qe=(t,e,n)=>(Jt(t,typeof e!="symbol"?e+"":e,n),n);var fe,_,Je,Kt,I,Be,Ke,ge,Qt,q={},Qe=[],Yt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,be=Array.isArray;function R(t,e){for(var n in e)t[n]=e[n];return t}s(R,"v");function Ye(t){var e=t.parentNode;e&&e.removeChild(t)}s(Ye,"p");function en(t,e,n){var r,o,i,c={};for(i in e)i=="key"?r=e[i]:i=="ref"?o=e[i]:c[i]=e[i];if(arguments.length>2&&(c.children=arguments.length>3?fe.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(i in t.defaultProps)c[i]===void 0&&(c[i]=t.defaultProps[i]);return se(t,c,r,o,null)}s(en,"y");function se(t,e,n,r,o){var i={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:o??++Je};return o==null&&_.vnode!=null&&_.vnode(i),i}s(se,"d");function E(t){return t.children}s(E,"k");function B(t,e){this.props=t,this.context=e}s(B,"b");function ae(t,e){if(e==null)return t.__?ae(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?ae(t):null}s(ae,"g");function et(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return et(t)}}s(et,"m");function Ge(t){(!t.__d&&(t.__d=!0)&&I.push(t)&&!ce.__r++||Be!==_.debounceRendering)&&((Be=_.debounceRendering)||Ke)(ce)}s(Ge,"w");function ce(){var t,e,n,r,o,i,c,u,l;for(I.sort(ge);t=I.shift();)t.__d&&(e=I.length,r=void 0,o=void 0,i=void 0,u=(c=(n=t).__v).__e,(l=n.__P)&&(r=[],o=[],(i=R({},c)).__v=c.__v+1,we(l,c,i,n.__n,l.ownerSVGElement!==void 0,c.__h!=null?[u]:null,r,u??ae(c),c.__h,o),it(r,c,o),c.__e!=u&&et(c)),I.length>e&&I.sort(ge));ce.__r=0}s(ce,"x");function tt(t,e,n,r,o,i,c,u,l,h,d){var a,b,y,p,v,T,g,m,S,j,A=0,O=r&&r.__k||Qe,V=O.length,H=V,P=e.length;for(n.__k=[],a=0;a<P;a++)(p=n.__k[a]=(p=e[a])==null||typeof p=="boolean"||typeof p=="function"?null:typeof p=="string"||typeof p=="number"||typeof p=="bigint"?se(null,p,null,null,p):be(p)?se(E,{children:p},null,null,null):p.__b>0?se(p.type,p.props,p.key,p.ref?p.ref:null,p.__v):p)!=null&&(p.__=n,p.__b=n.__b+1,(m=tn(p,O,g=a+A,H))===-1?y=q:(y=O[m]||q,O[m]=void 0,H--),we(t,p,y,o,i,c,u,l,h,d),v=p.__e,(b=p.ref)&&y.ref!=b&&(y.ref&&xe(y.ref,null,p),d.push(b,p.__c||v,p)),v!=null&&(T==null&&(T=v),j=!(S=y===q||y.__v===null)&&m===g,S?m==-1&&A--:m!==g&&(m===g+1?(A++,j=!0):m>g?H>P-g?(A+=m-g,j=!0):A--:A=m<g&&m==g-1?m-g:0),g=a+A,j=j||m==a&&!S,typeof p.type!="function"||m===g&&y.__k!==p.__k?typeof p.type=="function"||j?p.__d!==void 0?(l=p.__d,p.__d=void 0):l=v.nextSibling:l=rt(t,v,l):l=nt(p,l,t),typeof n.type=="function"&&(n.__d=l)));for(n.__e=T,a=V;a--;)O[a]!=null&&(typeof n.type=="function"&&O[a].__e!=null&&O[a].__e==n.__d&&(n.__d=O[a].__e.nextSibling),ot(O[a],O[a]))}s(tt,"P");function nt(t,e,n){for(var r,o=t.__k,i=0;o&&i<o.length;i++)(r=o[i])&&(r.__=t,e=typeof r.type=="function"?nt(r,e,n):rt(n,r.__e,e));return e}s(nt,"C");function rt(t,e,n){return n==null||n.parentNode!==t?t.insertBefore(e,null):e==n&&e.parentNode!=null||t.insertBefore(e,n),e.nextSibling}s(rt,"$");function tn(t,e,n,r){var o=t.key,i=t.type,c=n-1,u=n+1,l=e[n];if(l===null||l&&o==l.key&&i===l.type)return n;if(r>(l!=null?1:0))for(;c>=0||u<e.length;){if(c>=0){if((l=e[c])&&o==l.key&&i===l.type)return c;c--}if(u<e.length){if((l=e[u])&&o==l.key&&i===l.type)return u;u++}}return-1}s(tn,"A");function nn(t,e,n,r,o){var i;for(i in n)i==="children"||i==="key"||i in e||ue(t,i,null,n[i],r);for(i in e)o&&typeof e[i]!="function"||i==="children"||i==="key"||i==="value"||i==="checked"||n[i]===e[i]||ue(t,i,e[i],n[i],r)}s(nn,"H");function ze(t,e,n){e[0]==="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Yt.test(e)?n:n+"px"}s(ze,"I");function ue(t,e,n,r,o){var i;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||ze(t.style,e,"");if(n)for(e in n)r&&n[e]===r[e]||ze(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")i=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+i]=n,n?r||t.addEventListener(e,i?Ze:Xe,i):t.removeEventListener(e,i?Ze:Xe,i);else if(e!=="dangerouslySetInnerHTML"){if(o)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="width"&&e!=="height"&&e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e!=="rowSpan"&&e!=="colSpan"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!=="-"?t.removeAttribute(e):t.setAttribute(e,n))}}s(ue,"T");function Xe(t){return this.l[t.type+!1](_.event?_.event(t):t)}s(Xe,"j");function Ze(t){return this.l[t.type+!0](_.event?_.event(t):t)}s(Ze,"z");function we(t,e,n,r,o,i,c,u,l,h){var d,a,b,y,p,v,T,g,m,S,j,A,O,V,H,P=e.type;if(e.constructor!==void 0)return null;n.__h!=null&&(l=n.__h,u=e.__e=n.__e,e.__h=null,i=[u]),(d=_.__b)&&d(e);try{e:if(typeof P=="function"){if(g=e.props,m=(d=P.contextType)&&r[d.__c],S=d?m?m.props.value:d.__:r,n.__c?T=(a=e.__c=n.__c).__=a.__E:("prototype"in P&&P.prototype.render?e.__c=a=new P(g,S):(e.__c=a=new B(g,S),a.constructor=P,a.render=on),m&&m.sub(a),a.props=g,a.state||(a.state={}),a.context=S,a.__n=r,b=a.__d=!0,a.__h=[],a._sb=[]),a.__s==null&&(a.__s=a.state),P.getDerivedStateFromProps!=null&&(a.__s==a.state&&(a.__s=R({},a.__s)),R(a.__s,P.getDerivedStateFromProps(g,a.__s))),y=a.props,p=a.state,a.__v=e,b)P.getDerivedStateFromProps==null&&a.componentWillMount!=null&&a.componentWillMount(),a.componentDidMount!=null&&a.__h.push(a.componentDidMount);else{if(P.getDerivedStateFromProps==null&&g!==y&&a.componentWillReceiveProps!=null&&a.componentWillReceiveProps(g,S),!a.__e&&(a.shouldComponentUpdate!=null&&a.shouldComponentUpdate(g,a.__s,S)===!1||e.__v===n.__v)){for(e.__v!==n.__v&&(a.props=g,a.state=a.__s,a.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.forEach(function(oe){oe&&(oe.__=e)}),j=0;j<a._sb.length;j++)a.__h.push(a._sb[j]);a._sb=[],a.__h.length&&c.push(a);break e}a.componentWillUpdate!=null&&a.componentWillUpdate(g,a.__s,S),a.componentDidUpdate!=null&&a.__h.push(function(){a.componentDidUpdate(y,p,v)})}if(a.context=S,a.props=g,a.__P=t,a.__e=!1,A=_.__r,O=0,"prototype"in P&&P.prototype.render){for(a.state=a.__s,a.__d=!1,A&&A(e),d=a.render(a.props,a.state,a.context),V=0;V<a._sb.length;V++)a.__h.push(a._sb[V]);a._sb=[]}else do a.__d=!1,A&&A(e),d=a.render(a.props,a.state,a.context),a.state=a.__s;while(a.__d&&++O<25);a.state=a.__s,a.getChildContext!=null&&(r=R(R({},r),a.getChildContext())),b||a.getSnapshotBeforeUpdate==null||(v=a.getSnapshotBeforeUpdate(y,p)),tt(t,be(H=d!=null&&d.type===E&&d.key==null?d.props.children:d)?H:[H],e,n,r,o,i,c,u,l,h),a.base=e.__e,e.__h=null,a.__h.length&&c.push(a),T&&(a.__E=a.__=null)}else i==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=rn(n.__e,e,n,r,o,i,c,l,h);(d=_.diffed)&&d(e)}catch(oe){e.__v=null,(l||i!=null)&&(e.__e=u,e.__h=!!l,i[i.indexOf(u)]=null),_.__e(oe,e,n)}}s(we,"L");function it(t,e,n){for(var r=0;r<n.length;r++)xe(n[r],n[++r],n[++r]);_.__c&&_.__c(e,t),t.some(function(o){try{t=o.__h,o.__h=[],t.some(function(i){i.call(o)})}catch(i){_.__e(i,o.__v)}})}s(it,"M");function rn(t,e,n,r,o,i,c,u,l){var h,d,a,b=n.props,y=e.props,p=e.type,v=0;if(p==="svg"&&(o=!0),i!=null){for(;v<i.length;v++)if((h=i[v])&&"setAttribute"in h==!!p&&(p?h.localName===p:h.nodeType===3)){t=h,i[v]=null;break}}if(t==null){if(p===null)return document.createTextNode(y);t=o?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,y.is&&y),i=null,u=!1}if(p===null)b===y||u&&t.data===y||(t.data=y);else{if(i=i&&fe.call(t.childNodes),d=(b=n.props||q).dangerouslySetInnerHTML,a=y.dangerouslySetInnerHTML,!u){if(i!=null)for(b={},v=0;v<t.attributes.length;v++)b[t.attributes[v].name]=t.attributes[v].value;(a||d)&&(a&&(d&&a.__html==d.__html||a.__html===t.innerHTML)||(t.innerHTML=a&&a.__html||""))}if(nn(t,y,b,o,u),a)e.__k=[];else if(tt(t,be(v=e.props.children)?v:[v],e,n,r,o&&p!=="foreignObject",i,c,i?i[0]:n.__k&&ae(n,0),u,l),i!=null)for(v=i.length;v--;)i[v]!=null&&Ye(i[v]);u||("value"in y&&(v=y.value)!==void 0&&(v!==t.value||p==="progress"&&!v||p==="option"&&v!==b.value)&&ue(t,"value",v,b.value,!1),"checked"in y&&(v=y.checked)!==void 0&&v!==t.checked&&ue(t,"checked",v,b.checked,!1))}return t}s(rn,"N");function xe(t,e,n){try{typeof t=="function"?t(e):t.current=e}catch(r){_.__e(r,n)}}s(xe,"O");function ot(t,e,n){var r,o;if(_.unmount&&_.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||xe(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(i){_.__e(i,e)}r.base=r.__P=null,t.__c=void 0}if(r=t.__k)for(o=0;o<r.length;o++)r[o]&&ot(r[o],e,n||typeof t.type!="function");n||t.__e==null||Ye(t.__e),t.__=t.__e=t.__d=void 0}s(ot,"q");function on(t,e,n){return this.constructor(t,n)}s(on,"B");function k(t,e,n){var r,o,i,c;_.__&&_.__(t,e),o=(r=typeof n=="function")?null:n&&n.__k||e.__k,i=[],c=[],we(e,t=(!r&&n||e).__k=en(E,null,[t]),o||q,q,e.ownerSVGElement!==void 0,!r&&n?[n]:o?null:e.firstChild?fe.call(e.childNodes):null,i,!r&&n?n:o?o.__e:e.firstChild,r,c),it(i,t,c)}s(k,"D");fe=Qe.slice,_={__e:function(t,e,n,r){for(var o,i,c;e=e.__;)if((o=e.__c)&&!o.__)try{if((i=o.constructor)&&i.getDerivedStateFromError!=null&&(o.setState(i.getDerivedStateFromError(t)),c=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(t,r||{}),c=o.__d),c)return o.__E=o}catch(u){t=u}throw t}},Je=0,Kt=s(function(t){return t!=null&&t.constructor===void 0},"t"),B.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=R({},this.state),typeof t=="function"&&(t=t(R({},n),this.props)),t&&R(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),Ge(this))},B.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Ge(this))},B.prototype.render=E,I=[],Ke=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ge=s(function(t,e){return t.__v.__b-e.__v.__b},"f"),ce.__r=0,Qt=0;function ke(t){if(typeof t!="function")throw new TypeError("Expected a function");let e=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,n=["`",'"',"'"],r=t.toString().replace(e,""),o="",i=0,c=0;for(;c<r.length&&r.charAt(c)!==")";c+=1){if(r.startsWith("=>",c)){o=r,c=r.length;break}if(r.charAt(c)==="="){for(;c<r.length&&(r.charAt(c)!==","&&r.charAt(c)!==")"||i!==0);c+=1){let h=!1;for(let d of n)if(r.charAt(c)===d){for(c+=1;c<r.length&&r.charAt(c)!==d;)c+=1;h=!0;break}if(!h)switch(r.charAt(c)){case"(":case"[":case"{":i+=1;break;case")":case"]":case"}":i-=1;break;default:}}if(r.charAt(c)===","&&(o+=","),r.charAt(c)===")"){o+=")";break}}else o+=r.charAt(c)}c<r.length&&r.charAt(c)===")"&&(o+=")");let l=/^(?:async)?([^=()]+)=|\(([^)]+)\)/.exec(o);return l?(l[1]||l[2]).split(",").map(h=>h.trim()).filter(Boolean):[]}s(ke,"functionArguments");var G=s(function(){return G=Object.assign||s(function(e){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},"__assign"),G.apply(this,arguments)},"__assign");function st(t){return t.toLowerCase()}s(st,"lowerCase");var sn=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],an=/[^A-Z0-9]+/gi;function ct(t,e){e===void 0&&(e={});for(var n=e.splitRegexp,r=n===void 0?sn:n,o=e.stripRegexp,i=o===void 0?an:o,c=e.transform,u=c===void 0?st:c,l=e.delimiter,h=l===void 0?" ":l,d=at(at(t,r,"$1\0$2"),i,"\0"),a=0,b=d.length;d.charAt(a)==="\0";)a++;for(;d.charAt(b-1)==="\0";)b--;return d.slice(a,b).split("\0").map(u).join(h)}s(ct,"noCase");function at(t,e,n){return e instanceof RegExp?t.replace(e,n):e.reduce(function(r,o){return r.replace(o,n)},t)}s(at,"replace");function ut(t,e){return e===void 0&&(e={}),ct(t,G({delimiter:"."},e))}s(ut,"dotCase");function Ee(t,e){return e===void 0&&(e={}),ut(t,G({delimiter:"-"},e))}s(Ee,"paramCase");var W=256,lt=[],ft=256,le;for(;W--;)lt[W]=(W+256).toString(16).substring(1);function pt(t){var e=0,n=t||11;if(!le||W+n>ft*2)for(le="",W=0;e<ft;e++)le+=lt[Math.random()*256|0];return le.substring(W,W+++n)}s(pt,"uid");function ht(t){let e=ke(t);return new Map(e.map(n=>[Ee(n),n]))}s(ht,"getAttributes");function _t(t){return Ee(t.name)||"anonymous"}s(_t,"getName");function dt(t){return t.includes("-")&&!window.customElements.get(t)?t:`${t}-${pt(5).toLowerCase()}`}s(dt,"getUniqueName");function vt(t,e){return Object.fromEntries(Array.from(e.entries()).map(([r,o])=>{let i=t.getAttribute(r);return i=i===null?void 0:i,[o,i]}))}s(vt,"getArgumentValues");function J(t,e,n={}){return Object.fromEntries(Array.from(e.entries()).map(([,o])=>{let i=t[o]??n[o];return i=i===null?void 0:i,[o,i]}))}s(J,"getFieldValues");function mt(t,e,n,r){e.forEach(o=>{Object.defineProperty(t.prototype,o,{get(){return n.get(this)[o]},set(i){n.get(this)[o]!==i&&(n.get(this)[o]=i,r.get(this).self[K]())}})})}s(mt,"decorateWithProps");var Ce=Symbol("instance");function Se(t){return t[Ce]}s(Se,"getInstance");var K=Symbol("emit"),cn=s(async function*(){},"ag").constructor;function yt(t){return typeof t!="function"?!1:t instanceof cn}s(yt,"isGeneratorFunction");var Pe=class Pe extends String{constructor(e,n){super(e),this.element=n}define(e,n=window.customElements,r=void 0){let i=class i extends this.element{};s(i,"Clone");let o=i;n.define(e,o,r)}};s(Pe,"ExportWrapper");var Q=Pe;var un=Symbol("end");function Ae(t={},{yieldInit:e=!1,receiveEmitter:n=s(()=>{},"receiveEmitter")}={}){let r,o=s(()=>null,"emitChange");function i(){o(!0),c()}s(i,"emitter"),n(i);function c(){r=new Promise(l=>{o=l})}s(c,"watch");let u=new Proxy(t,{set(l,h,d){return l[h]=d,o(!0),c(),!0},get(l,h,d){return h===Symbol.asyncIterator?s(async function*(){for(e&&(yield l);;){if(!await r)return l;yield l}},"iterator"):h===un?()=>o(!1):Reflect.get(l,h,d)}});return c(),u}s(Ae,"mutationIterator");function Oe(t,e){let n,r;function o(i){return r=i,n}return s(o,"base"),o[Ce]=t,Object.defineProperty(o,"props",{get(){return{...J(t,e,r)}}}),Object.defineProperty(o,"children",{get(){return[...t.childNodes]}}),n=Ae(o,{yieldInit:!0,receiveEmitter:i=>{o[K]=i}}),n}s(Oe,"self");function U(t,...e){let n=Se(t);return n.dispatchEvent.call(n,...e)}s(U,"dispatchEvent");function gt(t){return Se(t).shadowRoot}s(gt,"getDom");function x(t,e,{baseElement:n=void 0,baseClass:r=HTMLElement,effect:o=void 0}={}){let i=_t(t),c=dt(i),u=ht(t),l=yt(t),h=new WeakMap,d=new WeakMap,p=class p extends r{constructor(){super(),h.set(this,{}),d.set(this,{}),this.attachShadow({mode:"open"}),h.get(this).self=Oe(this,u),h.get(this).componentFunc=t.bind(h.get(this).self),h.get(this).isFirstRender=!0}static get observedAttributes(){return Array.from(u.keys())}connectedCallback(){this.setAttribute("data-component",i);let T=vt(this,u);Object.entries(T).forEach(([g,m])=>{m&&(this[g]=m)}),b.call(this)}attributeChangedCallback(T,g,m){let S=u.get(T);this[S]=m}};s(p,"Comp");let a=p;async function b(){let{componentFunc:v}=h.get(this);if(!l){for await(let g of h.get(this).self){let m=J(this,u),S=await v(...Object.values(m));e(S,this.shadowRoot)}return}let T=J(this,u);for await(let g of v(...Object.values(T)))if(e(g,this.shadowRoot),h.get(this).isFirstRender&&o){h.get(this).isFirstRender=!1;for(let m in h.get(this).self)typeof h.get(this).self[m]=="object"&&"value"in h.get(this).self[m]&&o(()=>{let S=h.get(this).self[m]?.value;h.get(this).self[K]()})}}s(b,"renderLoop"),mt(a,u,d,h);let y=new Q(c,a);return y.define(c,void 0,n?{extends:n}:void 0),y}s(x,"asWebComponent");var Te,D,De,bt,wt=0,At=[],pe=[],xt=_.__b,kt=_.__r,Et=_.diffed,Ct=_.__c,St=_.unmount;function fn(t,e){_.__h&&_.__h(D,t,wt||e),wt=0;var n=D.__H||(D.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({__V:pe}),n.__[t]}s(fn,"d");function Le(t,e){var n=fn(Te++,7);return hn(n.__H,e)?(n.__V=t(),n.i=e,n.__h=t,n.__V):n.__}s(Le,"F");function ln(){for(var t;t=At.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(he),t.__H.__h.forEach(je),t.__H.__h=[]}catch(e){t.__H.__h=[],_.__e(e,t.__v)}}s(ln,"b");_.__b=function(t){D=null,xt&&xt(t)},_.__r=function(t){kt&&kt(t),Te=0;var e=(D=t.__c).__H;e&&(De===D?(e.__h=[],D.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=pe,n.__N=n.i=void 0})):(e.__h.forEach(he),e.__h.forEach(je),e.__h=[],Te=0)),De=D},_.diffed=function(t){Et&&Et(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(At.push(e)!==1&&bt===_.requestAnimationFrame||((bt=_.requestAnimationFrame)||pn)(ln)),e.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==pe&&(n.__=n.__V),n.i=void 0,n.__V=pe})),De=D=null},_.__c=function(t,e){e.some(function(n){try{n.__h.forEach(he),n.__h=n.__h.filter(function(r){return!r.__||je(r)})}catch(r){e.some(function(o){o.__h&&(o.__h=[])}),e=[],_.__e(r,n.__v)}}),Ct&&Ct(t,e)},_.unmount=function(t){St&&St(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{he(r)}catch(o){e=o}}),n.__H=void 0,e&&_.__e(e,n.__v))};var Pt=typeof requestAnimationFrame=="function";function pn(t){var e,n=s(function(){clearTimeout(r),Pt&&cancelAnimationFrame(e),setTimeout(t)},"r"),r=setTimeout(n,100);Pt&&(e=requestAnimationFrame(n))}s(pn,"j");function he(t){var e=D,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),D=e}s(he,"k");function je(t){var e=D;t.__c=t.__(),D=e}s(je,"w");function hn(t,e){return!t||t.length!==e.length||e.some(function(n,r){return n!==t[r]})}s(hn,"z");function de(){throw new Error("Cycle detected")}s(de,"i");function Re(){if(z>1)z--;else{for(var t,e=!1;Y!==void 0;){var n=Y;for(Y=void 0,Ne++;n!==void 0;){var r=n.o;if(n.o=void 0,n.f&=-3,!(8&n.f)&&Dt(n))try{n.c()}catch(o){e||(t=o,e=!0)}n=r}}if(Ne=0,z--,e)throw t}}s(Re,"t");var w=void 0,Y=void 0,z=0,Ne=0,_e=0;function Ot(t){if(w!==void 0){var e=t.n;if(e===void 0||e.t!==w)return e={i:0,S:t,p:w.s,n:void 0,t:w,e:void 0,x:void 0,r:e},w.s!==void 0&&(w.s.n=e),w.s=e,t.n=e,32&w.f&&t.S(e),e;if(e.i===-1)return e.i=0,e.n!==void 0&&(e.n.p=e.p,e.p!==void 0&&(e.p.n=e.n),e.p=w.s,e.n=void 0,w.s.n=e,w.s=e),e}}s(Ot,"v");function C(t){this.v=t,this.i=0,this.n=void 0,this.t=void 0}s(C,"e");C.prototype.h=function(){return!0};C.prototype.S=function(t){this.t!==t&&t.e===void 0&&(t.x=this.t,this.t!==void 0&&(this.t.e=t),this.t=t)};C.prototype.U=function(t){if(this.t!==void 0){var e=t.e,n=t.x;e!==void 0&&(e.x=n,t.e=void 0),n!==void 0&&(n.e=e,t.x=void 0),t===this.t&&(this.t=n)}};C.prototype.subscribe=function(t){var e=this;return N(function(){var n=e.value,r=32&this.f;this.f&=-33;try{t(n)}finally{this.f|=r}})};C.prototype.valueOf=function(){return this.value};C.prototype.toString=function(){return this.value+""};C.prototype.toJSON=function(){return this.value};C.prototype.peek=function(){return this.v};Object.defineProperty(C.prototype,"value",{get:function(){var t=Ot(this);return t!==void 0&&(t.i=this.i),this.v},set:function(t){if(w instanceof M&&function(){throw new Error("Computed cannot have side-effects")}(),t!==this.v){Ne>100&&de(),this.v=t,this.i++,_e++,z++;try{for(var e=this.t;e!==void 0;e=e.x)e.t.N()}finally{Re()}}}});function L(t){return new C(t)}s(L,"u");function Dt(t){for(var e=t.s;e!==void 0;e=e.n)if(e.S.i!==e.i||!e.S.h()||e.S.i!==e.i)return!0;return!1}s(Dt,"c");function Tt(t){for(var e=t.s;e!==void 0;e=e.n){var n=e.S.n;if(n!==void 0&&(e.r=n),e.S.n=e,e.i=-1,e.n===void 0){t.s=e;break}}}s(Tt,"d");function jt(t){for(var e=t.s,n=void 0;e!==void 0;){var r=e.p;e.i===-1?(e.S.U(e),r!==void 0&&(r.n=e.n),e.n!==void 0&&(e.n.p=r)):n=e,e.S.n=e.r,e.r!==void 0&&(e.r=void 0),e=r}t.s=n}s(jt,"a");function M(t){C.call(this,void 0),this.x=t,this.s=void 0,this.g=_e-1,this.f=4}s(M,"l");(M.prototype=new C).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===_e))return!0;if(this.g=_e,this.f|=1,this.i>0&&!Dt(this))return this.f&=-2,!0;var t=w;try{Tt(this),w=this;var e=this.x();(16&this.f||this.v!==e||this.i===0)&&(this.v=e,this.f&=-17,this.i++)}catch(n){this.v=n,this.f|=16,this.i++}return w=t,jt(this),this.f&=-2,!0};M.prototype.S=function(t){if(this.t===void 0){this.f|=36;for(var e=this.s;e!==void 0;e=e.n)e.S.S(e)}C.prototype.S.call(this,t)};M.prototype.U=function(t){if(this.t!==void 0&&(C.prototype.U.call(this,t),this.t===void 0)){this.f&=-33;for(var e=this.s;e!==void 0;e=e.n)e.S.U(e)}};M.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var t=this.t;t!==void 0;t=t.x)t.t.N()}};M.prototype.peek=function(){if(this.h()||de(),16&this.f)throw this.v;return this.v};Object.defineProperty(M.prototype,"value",{get:function(){1&this.f&&de();var t=Ot(this);if(this.h(),t!==void 0&&(t.i=this.i),16&this.f)throw this.v;return this.v}});function ee(t){return new M(t)}s(ee,"w");function Lt(t){var e=t.u;if(t.u=void 0,typeof e=="function"){z++;var n=w;w=void 0;try{e()}catch(r){throw t.f&=-2,t.f|=8,Ue(t),r}finally{w=n,Re()}}}s(Lt,"y");function Ue(t){for(var e=t.s;e!==void 0;e=e.n)e.S.U(e);t.x=void 0,t.s=void 0,Lt(t)}s(Ue,"_");function _n(t){if(w!==this)throw new Error("Out-of-order effect");jt(this),w=t,this.f&=-2,8&this.f&&Ue(this),Re()}s(_n,"p");function te(t){this.x=t,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}s(te,"g");te.prototype.c=function(){var t=this.S();try{if(8&this.f||this.x===void 0)return;var e=this.x();typeof e=="function"&&(this.u=e)}finally{t()}};te.prototype.S=function(){1&this.f&&de(),this.f|=1,this.f&=-9,Lt(this),Tt(this),z++;var t=w;return w=this,_n.bind(this,t)};te.prototype.N=function(){2&this.f||(this.f|=2,this.o=Y,Y=this)};te.prototype.d=function(){this.f|=8,1&this.f||Ue(this)};function N(t){var e=new te(t);try{e.c()}catch(n){throw e.d(),n}return e.d.bind(e)}s(N,"b");var Fe,Me;function X(t,e){_[t]=e.bind(null,_[t]||function(){})}s(X,"s");function ve(t){Me&&Me(),Me=t&&t.S()}s(ve,"l");function Nt(t){var e=this,n=t.data,r=vn(n);r.value=n;var o=Le(function(){for(var i=e.__v;i=i.__;)if(i.__c){i.__c.__$f|=4;break}return e.__$u.c=function(){e.base.data=o.peek()},ee(function(){var c=r.value.value;return c===0?0:c===!0?"":c||""})},[]);return o.value}s(Nt,"d");Nt.displayName="_st";Object.defineProperties(C.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:Nt},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});X("__b",function(t,e){if(typeof e.type=="string"){var n,r=e.props;for(var o in r)if(o!=="children"){var i=r[o];i instanceof C&&(n||(e.__np=n={}),n[o]=i,r[o]=i.peek())}}t(e)});X("__r",function(t,e){ve();var n,r=e.__c;r&&(r.__$f&=-2,(n=r.__$u)===void 0&&(r.__$u=n=function(o){var i;return N(function(){i=this}),i.c=function(){r.__$f|=1,r.setState({})},i}())),Fe=r,ve(n),t(e)});X("__e",function(t,e,n,r){ve(),Fe=void 0,t(e,n,r)});X("diffed",function(t,e){ve(),Fe=void 0;var n;if(typeof e.type=="string"&&(n=e.__e)){var r=e.__np,o=e.props;if(r){var i=n.U;if(i)for(var c in i){var u=i[c];u!==void 0&&!(c in r)&&(u.d(),i[c]=void 0)}else n.U=i={};for(var l in r){var h=i[l],d=r[l];h===void 0?(h=dn(n,l,d,o),i[l]=h):h.o(d,o)}}}t(e)});function dn(t,e,n,r){var o=e in t&&t.ownerSVGElement===void 0,i=L(n);return{o:function(c,u){i.value=c,r=u},d:N(function(){var c=i.value.value;r[e]!==c&&(r[e]=c,o?t[e]=c:c?t.setAttribute(e,c):t.removeAttribute(e))})}}s(dn,"p");X("unmount",function(t,e){if(typeof e.type=="string"){var n=e.__e;if(n){var r=n.U;if(r){n.U=void 0;for(var o in r){var i=r[o];i&&i.d()}}}}else{var c=e.__c;if(c){var u=c.__$u;u&&(c.__$u=void 0,u.d())}}t(e)});X("__h",function(t,e,n,r){(r<3||r===9)&&(e.__$f|=2),t(e,n,r)});B.prototype.shouldComponentUpdate=function(t,e){var n=this.__$u;if(!(n&&n.s!==void 0||4&this.__$f)||3&this.__$f)return!0;for(var r in e)return!0;for(var o in t)if(o!=="__source"&&t[o]!==this.props[o])return!0;for(var i in this.props)if(!(i in t))return!0;return!1};function vn(t){return Le(function(){return L(t)},[])}s(vn,"useSignal");var me=L(!1);async function Rt(){try{console.log("Requesting WakeLock"),await navigator.wakeLock.request("screen"),me.value=!0}catch(t){console.error("WakeLock",t),me.value=!1}}s(Rt,"disableScreenLock");var mn=0;function f(t,e,n,r,o,i){var c,u,l={};for(u in e)u=="ref"?c=e[u]:l[u]=e[u];var h={type:t,props:l,key:n,ref:c,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--mn,__source:o,__self:i};if(typeof t=="function"&&(c=t.defaultProps))for(u in c)l[u]===void 0&&(l[u]=c[u]);return _.vnode&&_.vnode(h),h}s(f,"o");async function*yn(){this.wakeLockDisabled=me;for await(let{wakeLockDisabled:t}of this)yield f(E,{children:[f("link",{rel:"stylesheet",href:"/dist/main.css"}),f("span",{children:"\u{1F505}"}),!t.value&&f("span",{children:"\u{1F6AB}"})]})}s(yn,"WakeLock");var Ut=x(yn,k,{effect:N});var Mt={name:"remote-control",version:"1.2.0",description:"BLE Remote Control",main:"src/index.html",directories:{doc:"docs"},scripts:{test:"npm run lint && npm run build",start:"esbuild src/main.js --bundle --outdir=public/dist --jsx-import-source=preact --jsx=automatic --target=safari16 --watch --servedir=public --sourcemap",build:"esbuild src/main.js --bundle --outdir=dist/dist --jsx-import-source=preact --jsx=automatic --target=safari16 --minify --keep-names && cp -r public/. dist/",lint:"eslint src",deploy:"gh-pages -d dist"},repository:{type:"git",url:"git+https://github.com/DavidBeale/remote-control.git"},author:"David Beale",license:"MIT",bugs:{url:"https://github.com/DavidBeale/remote-control/issues"},homepage:"https://github.com/DavidBeale/remote-control#readme",devDependencies:{"browser-sync":"^2.27.9",esbuild:"^0.18.16",eslint:"^8.45.0","eslint-config-airbnb":"^19.0.4","eslint-config-prettier":"^8.8.0","eslint-plugin-prettier":"^5.0.0","gh-pages":"^5.0.0"},dependencies:{"@picocss/pico":"^2.0.0-alpha1","@preact/signals":"^1.1.5","as-web-component":"^0.6.2",multirator:"^0.1.0",preact:"^10.16.0"}};function bn(){return f(E,{children:[f("link",{rel:"stylesheet",href:"/dist/main.css"}),f("header",{children:[f("h1",{children:["BLE Remote Control (",Mt.version,")"]}),f(Ut,{})]})]})}s(bn,"Header");var Ft=x(bn,k);async function wn(t,e){let n=s(o=>{U(this,new CustomEvent("change",{detail:{name:o}}))},"select"),r=s(o=>{U(this,new CustomEvent("Menu",{detail:o.target.value})),o.target.value=""},"menuSelect");return f(E,{children:[f("link",{rel:"stylesheet",href:"/dist/main.css"}),f("nav",{children:[f("div",{role:"group",children:t.map(o=>o===e?f("button",{"aria-current":"true",children:o}):f("button",{class:"secondary",onClick:()=>n(o),children:o}))}),f("select",{onChange:r,value:"",children:[f("option",{value:"",disabled:!0,children:"..."}),f("option",{children:"Add Device"}),f("option",{children:"Disconnect"})]})]})]})}s(wn,"DeviceSelector");var Vt=x(wn,k);var ne={"0000000a-0000-1000-8000-00805f9b34fb":{name:"engine",label:"Engine"},"0000000b-0000-1000-8000-00805f9b34fb":{name:"headlight",label:"Head Light"},"0000000c-0000-1000-8000-00805f9b34fb":{name:"cablight",label:"Cab Light"},"0000000d-0000-1000-8000-00805f9b34fb":{name:"velocity"},"0000000e-0000-1000-8000-00805f9b34fb":{name:"speed"}};async function*xn(t){this.checked=!1;let e=s(n=>{n.target.checked?this.props.feature.writeValue(Uint8Array.from([1])):this.props.feature.writeValue(Uint8Array.from([0]))},"checked");for await(let{props:n}of this(t))this.checked=(await n.feature.readValue()).getUint8(),n.feature.value.map(r=>(this.checked=r.getUint8(),null)),yield f(E,{children:[f("link",{rel:"stylesheet",href:"/dist/main.css"}),f("label",{children:[f("input",{type:"checkbox",role:"switch",checked:this.checked,onChange:e}),ne[n.feature.uuid].label]})]})}s(xn,"SwitchFeature");var Ht=x(xn,k);async function*kn(t=0){yield f(E,{children:[f("link",{rel:"stylesheet",href:"/dist/main.css"}),f("input",{type:"range",value:t,onChange:n=>U(this,new CustomEvent("change",{detail:n.target.valueAsNumber})),min:"0",max:"100",step:"5"}),f("button",{id:"stop",onClick:()=>U(this,new CustomEvent("change",{detail:0})),children:"Stop"})]});let e=gt(this).querySelector("input");new Ve(e,{range:"circular"});for await(let{props:n}of this({speed:t}))e.value=n.speed,e.dispatchEvent(new Event("input"))}s(kn,"Throttle");var It=x(kn,k),He=class He{constructor(e,n){this.settings={clsCircular:"c-rng--circular",clsCircularOutput:"c-rng--circular-output",clsOutput:"c-rng__output",clsOutputWrapper:"c-rng--output",clsRangeTicks:"c-rng--ticks",clsWrapper:"c-rng__wrapper",offset:-90,varPercent:"--rng-percent",varPercentUpper:"--rng-percent-upper",varThumb:"--rng-thumb-w",varUnit:"--rng-unit",varValue:"--rng-value",...En(n)},this.range=e,this.initRange(this.range)}initRange(e){let n=this.settings.range.includes("circular");e.id=e.id||Cn(),this.lower=this.settings.range.includes("upper")?e.parentNode.querySelector('[data-range*="lower"]'):null,this.max=parseInt(e.max,10)||100,this.min=parseInt(e.min,10),this.multiplier=100/(this.max-this.min),this.output=this.settings.range.includes("output")||n?document.createElement("output"):null,this.ticks=parseInt(e.dataset.ticks,10),this.upper=this.settings.range.includes("lower")?e.parentNode.querySelector('[data-range*="upper"]'):null;let r=this.lower||this.upper;if(this.wrapper=r?e.parentNode:document.createElement("div"),this.output&&(this.output.className=n?this.settings.clsCircularOutput:this.settings.clsOutput,this.output.for=e.id,r?this.wrapper.insertBefore(this.output,e):(this.wrapper.classList.add(n?this.settings.clsCircular:this.settings.clsOutputWrapper),this.wrapper.appendChild(this.output))),r||(e.parentNode.insertBefore(this.wrapper,e),this.wrapper.appendChild(e)),e.dataset.modifier&&this.wrapper.classList.add(e.dataset.modifier),this.wrapper.classList.add(this.settings.clsWrapper),this.wrapper.style.setProperty(this.settings.varThumb,getComputedStyle(e).getPropertyValue(this.settings.varThumb)),this.ticks){let o=[...Array(this.ticks).keys()],i=`
          <svg class="${this.settings.clsRangeTicks}" width="100%" height="100%">
          ${o.map(c=>`<rect x="${100/this.ticks*c}%" y="5" width="1" height="100%"></rect>`).join("")}
          <rect x="100%" y="5" width="1" height="100%"></rect>
        </svg>`;this.wrapper.insertAdjacentHTML("afterbegin",i)}if(n){e.hidden=!0;let o=s(i=>this.updateCircle(this.rotate(i.pageX,i.pageY)),"pointerMove");this.setCenter(),this.output.setAttribute("tabindex",0),this.output.addEventListener("keydown",i=>{switch(i.key){case"ArrowLeft":case"ArrowDown":i.preventDefault(),this.range.stepDown(),this.updateCircle();break;case"ArrowRight":case"ArrowUp":i.preventDefault(),this.range.stepUp(),this.updateCircle();break;default:break}}),this.output.addEventListener("pointerdown",()=>this.output.addEventListener("pointermove",o)),this.output.addEventListener("pointerup",()=>this.output.removeEventListener("pointermove",o)),e.addEventListener("input",()=>this.updateCircle(0)),this.updateCircle()}else e.addEventListener("input",()=>this.updateRange());e.dispatchEvent(new Event("input"))}rotate(e,n){return Math.atan2(n-this.center.y,e-this.center.x)*180/Math.PI}setCenter(){let e=this.wrapper.getBoundingClientRect();this.center={x:e.left+e.width/2,y:e.top+e.height/2}}updateCircle(e){let n=e,r=360/(this.max-this.min);n||(n=r*this.range.valueAsNumber+this.settings.offset);let o=n-this.settings.offset;o<0&&(o+=360);let i=Math.ceil(o/r);i>this.range.max||i<this.range.min||(this.range.value=i,this.range.dispatchEvent(new Event("change",{bubbles:!0})),this.wrapper.dataset.value=this.range.value,this.wrapper.style.setProperty("--angle",`${n}deg`),this.wrapper.style.setProperty("--gradient-end",`${o}deg`))}updateRange(){if(this.lower&&this.lower.valueAsNumber>this.range.valueAsNumber){this.range.value=this.lower.valueAsNumber,this.range.dispatchEvent(new Event("input",{bubbles:!0}));return}if(this.upper&&this.upper.valueAsNumber<this.range.valueAsNumber){this.range.value=this.upper.valueAsNumber,this.range.dispatchEvent(new Event("input",{bubbles:!0}));return}let e=(this.range.valueAsNumber-this.min)*this.multiplier;this.range.style.setProperty(this.settings.varPercent,`${e}%`),this.range.style.setProperty(this.settings.varValue,`${this.range.valueAsNumber}`),this.lower&&this.lower.style.setProperty(this.settings.varPercentUpper,`${e}%`),this.output&&(this.output.style.setProperty(this.settings.varUnit,`${e}`),this.output.innerText=this.range.value)}};s(He,"RangeSlider");var Ve=He;function En(t){let e={...t};return Object.keys(e).forEach(n=>{typeof e[n]=="string"&&e[n].charAt(0)===":"&&(e[n]=JSON.parse(e[n].slice(1)))}),e}s(En,"stringToType");function Cn(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16))}s(Cn,"uuid");async function Sn(t,e={},n=!1,r=1){let o=Object.entries(e),i=Math.min(...o.map(([,u])=>u)),c=Math.max(...o.map(([,u])=>u));return f(E,{children:[f("link",{rel:"stylesheet",href:"/dist/main.css"}),f("input",{type:"range",value:t,disabled:n,onChange:u=>U(this,new CustomEvent("change",{detail:u.target.valueAsNumber})),min:i,max:c,step:r,list:"markers"}),f("datalist",{id:"markers",children:o.map(([u,l])=>f("option",{value:l,children:u}))})]})}s(Sn,"Direction");var Wt=x(Sn,k);function Ie(t,e){let n=0;return s(function(...o){let i=new Date().getTime();i-n<e||(n=i,t(...o))},"t")}s(Ie,"throttle");async function*Pn(t){this.speed=0,this.direction=1;let e=Ie(r=>{this.speed=r.detail,this.props.feature.writeValue(Int8Array.from([this.speed*this.direction]))},100),n=s(r=>{this.direction=r.detail,this.props.feature.writeValue(Int8Array.from([this.speed*this.direction]))},"changeDirection");[this.speed,this.direction]=$t(await t.readValue());for await(let{props:r}of this(t)){r.feature.value.map(i=>([this.speed,this.direction]=$t(i),null));let o=this.speed!==0;yield f("article",{children:[f("link",{rel:"stylesheet",href:"/dist/main.css"}),f(Wt,{gear:this.direction,gears:{Reverse:-1,Forward:1},step:2,disabled:o,onChange:n}),f(It,{speed:this.speed,onChange:e})]})}}s(Pn,"VelocityFeature");var qt=x(Pn,k);function $t(t){let e=t.getInt8(0),n=Math.abs(e),r=1;return e<0&&(r=-1),[n,r]}s($t,"splitValues");async function An(t){let{features:e}=t,n=e.find(r=>ne[r.uuid]?.name==="velocity");return f("section",{children:[f("link",{rel:"stylesheet",href:"/dist/main.css"}),f("article",{children:f("fieldset",{children:e.filter(r=>ne[r.uuid].label).map(r=>f(Ht,{feature:r}))})}),n&&f(qt,{feature:n})]})}s(An,"Controls");var Bt=x(An,k);var Z=class Z{constructor(e){this[Symbol.asyncIterator]=s(async function*(){for await(let r of e)yield r},"iter")}filter(e){return new Z(On(this,e))}map(e){return new Z(Dn(this,e))}concat(e){return new Z(Tn(this,e))}async forEach(e){for await(let n of this)e(n)}async reduce(e,n){let r=n;for await(let o of this)r===void 0?r=o:r=e(r,o);return r}};s(Z,"Iterator");var re=Z;async function*On(t,e){for await(let n of t)e(n)&&(yield n)}s(On,"filter");async function*Dn(t,e){for await(let n of t)yield e(n)}s(Dn,"map");async function*Tn(t,e){for await(let n of t)yield n;for await(let n of e)yield n}s(Tn,"concat");var We=class We extends re{constructor(e){super(e);let n=!1,r,o,i,c=new Promise((u,l)=>{o=u,i=l});(async()=>{for(;!n;)try{let u=await e.next();n=u.done,r=u.value,o(u)}catch(u){i(u)}finally{c=new Promise((u,l)=>{o=u,i=l})}})(),this[Symbol.asyncIterator]=s(async function*(){for(!n&&r!==void 0&&(yield r);!n;)await c,n||(yield r)},"iter")}};s(We,"Multirator");var ie=We;var Gt=Promise.resolve();function ye(t){return Gt=jn(t)}s(ye,"enqueue");async function jn(t){try{await Gt}finally{return t()}}s(jn,"run");var zt="e4580f53-0298-41fa-8210-ce8f8bbe23a3",$=class ${constructor(e){this.deviceName=e,this.device=void 0,this.primaryService=void 0,this.featureMap={},this.isConnected=L(!1)}static async select(e){$.selectOpen.value=!0;try{return await navigator.bluetooth.requestDevice({filters:e?[{name:e}]:[{services:[zt]},{services:["6e400001-b5a3-f393-e0a9-e50e24dcca9e"]}]})}finally{$.selectOpen.value=!1}}get features(){return Object.values(this.featureMap)}async connect(e){this.device=e,console.log("Connecting to device",this.device?.name);try{await this.device.gatt.connect(),console.log("Connected to device",this.device?.name),this.primaryService=await this.device.gatt.getPrimaryService(zt),this.device.addEventListener("gattserverdisconnected",Xt.bind(this)),await Ln.call(this),this.isConnected.value=!0}catch(n){console.error("Failed to connect to Device"),console.error(n.stack??n),console.log("Retrying in 3secs"),this.isConnected.value=!1,setTimeout(async()=>{let r=await $.select(this.device.name);this.connect(r)},3e3)}}disconnect(){this.device&&(this.device.removeEventListener("gattserverdisconnected",Xt),this.isConnected.value=!1,this.device.gatt.disconnect())}};s($,"TrainService"),qe($,"selectOpen",L(!1));var F=$;function Xt(){this.isConnected.value&&(console.log("Disconnected from device",this.device?.name??"Unknown"),this.connect(this.device))}s(Xt,"reConnect");async function Ln(){let t=await this.primaryService.getCharacteristics();for(let e of t)this.featureMap[e.uuid]||(this.featureMap[e.uuid]={uuid:e.uuid},this.featureMap[e.uuid].value=new ie(s(async function*(){for(e.value&&(yield e.value);;)yield new Promise(r=>{this.featureMap[e.uuid].resolver=r})},"emit").call(this))),this.featureMap[e.uuid].writeValue=n=>ye(()=>e.writeValue.call(e,n)),this.featureMap[e.uuid].readValue=()=>ye(()=>e.readValue.call(e)),e.addEventListener("characteristicvaluechanged",async()=>{this.featureMap[e.uuid]?.resolver(e.value)}),e.startNotifications(),this.featureMap[e.uuid].readValue().then(()=>{this.featureMap[e.uuid]?.resolver(e.value)})}s(Ln,"loadFeatures");async function Nn(t){return f("section",{children:[f("link",{rel:"stylesheet",href:"/dist/main.css"}),f("button",{onClick:s(async()=>{Rt();let n=await F.select();t.connect(n)},"connect"),children:"Connect"})]})}s(Nn,"Connect");var Zt=x(Nn,k);async function*Rn(){let t=["Star","Jessie"],e=Object.fromEntries(t.map(o=>[o,new F(o)]));this.status=ee(()=>Object.entries(e).map(([,o])=>o.isConnected.value)),[this.currentDeviceName=""]=t,this.selectOpen=F.selectOpen;let n=s(o=>{this.currentDeviceName=o},"changeDevice"),r=s(o=>{switch(o){case"Disconnect":{e[this.currentDeviceName].disconnect();break}}},"menuSelected");for await(let{currentDeviceName:o,selectOpen:i}of this){let c=e[o];yield f(E,{children:[f("link",{rel:"stylesheet",href:"/dist/main.css"}),f("style",{children:`
           :host {
            ${i.value?"opacity: 10%; pointer-events: none;":""}
           }
          `}),f(Ft,{}),f("main",{class:"container-fluid",children:[f(Vt,{devices:t,currentDeviceName:o,onChange:u=>n(u.detail.name),onMenu:u=>r(u.detail)}),c.isConnected.value?f(Bt,{service:c}):f(Zt,{service:c})]})]})}}s(Rn,"RemoteControl");var rs=x(Rn,k,{effect:N});window.location.hostname==="localhost"&&new EventSource("/esbuild").addEventListener("change",()=>window.location.reload());})();
