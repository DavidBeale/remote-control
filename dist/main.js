(()=>{var n,l,u,t,i,o,r,f,e,c={},s=[],a=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,h=Array.isArray;function v(n3,l5){for(var u4 in l5)n3[u4]=l5[u4];return n3}function p(n3){var l5=n3.parentNode;l5&&l5.removeChild(n3)}function y(l5,u4,t4){var i4,o5,r4,f4={};for(r4 in u4)r4=="key"?i4=u4[r4]:r4=="ref"?o5=u4[r4]:f4[r4]=u4[r4];if(arguments.length>2&&(f4.children=arguments.length>3?n.call(arguments,2):t4),typeof l5=="function"&&l5.defaultProps!=null)for(r4 in l5.defaultProps)f4[r4]===void 0&&(f4[r4]=l5.defaultProps[r4]);return d(l5,f4,i4,o5,null)}function d(n3,t4,i4,o5,r4){var f4={type:n3,props:t4,key:i4,ref:o5,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:r4??++u};return r4==null&&l.vnode!=null&&l.vnode(f4),f4}function k(n3){return n3.children}function b(n3,l5){this.props=n3,this.context=l5}function g(n3,l5){if(l5==null)return n3.__?g(n3.__,n3.__.__k.indexOf(n3)+1):null;for(var u4;l5<n3.__k.length;l5++)if((u4=n3.__k[l5])!=null&&u4.__e!=null)return u4.__e;return typeof n3.type=="function"?g(n3):null}function m(n3){var l5,u4;if((n3=n3.__)!=null&&n3.__c!=null){for(n3.__e=n3.__c.base=null,l5=0;l5<n3.__k.length;l5++)if((u4=n3.__k[l5])!=null&&u4.__e!=null){n3.__e=n3.__c.base=u4.__e;break}return m(n3)}}function w(n3){(!n3.__d&&(n3.__d=!0)&&i.push(n3)&&!x.__r++||o!==l.debounceRendering)&&((o=l.debounceRendering)||r)(x)}function x(){var n3,l5,u4,t4,o5,r4,e4,c5,s4;for(i.sort(f);n3=i.shift();)n3.__d&&(l5=i.length,t4=void 0,o5=void 0,r4=void 0,c5=(e4=(u4=n3).__v).__e,(s4=u4.__P)&&(t4=[],o5=[],(r4=v({},e4)).__v=e4.__v+1,L(s4,e4,r4,u4.__n,s4.ownerSVGElement!==void 0,e4.__h!=null?[c5]:null,t4,c5??g(e4),e4.__h,o5),M(t4,e4,o5),e4.__e!=c5&&m(e4)),i.length>l5&&i.sort(f));x.__r=0}function P(n3,l5,u4,t4,i4,o5,r4,f4,e4,a4,v5){var p5,y3,_4,b4,g4,m3,w4,x2,P2,S,H2=0,I2=t4&&t4.__k||s,T2=I2.length,j3=T2,z3=l5.length;for(u4.__k=[],p5=0;p5<z3;p5++)(b4=u4.__k[p5]=(b4=l5[p5])==null||typeof b4=="boolean"||typeof b4=="function"?null:typeof b4=="string"||typeof b4=="number"||typeof b4=="bigint"?d(null,b4,null,null,b4):h(b4)?d(k,{children:b4},null,null,null):b4.__b>0?d(b4.type,b4.props,b4.key,b4.ref?b4.ref:null,b4.__v):b4)!=null&&(b4.__=u4,b4.__b=u4.__b+1,(x2=A(b4,I2,w4=p5+H2,j3))===-1?_4=c:(_4=I2[x2]||c,I2[x2]=void 0,j3--),L(n3,b4,_4,i4,o5,r4,f4,e4,a4,v5),g4=b4.__e,(y3=b4.ref)&&_4.ref!=y3&&(_4.ref&&O(_4.ref,null,b4),v5.push(y3,b4.__c||g4,b4)),g4!=null&&(m3==null&&(m3=g4),S=!(P2=_4===c||_4.__v===null)&&x2===w4,P2?x2==-1&&H2--:x2!==w4&&(x2===w4+1?(H2++,S=!0):x2>w4?j3>z3-w4?(H2+=x2-w4,S=!0):H2--:H2=x2<w4&&x2==w4-1?x2-w4:0),w4=p5+H2,S=S||x2==p5&&!P2,typeof b4.type!="function"||x2===w4&&_4.__k!==b4.__k?typeof b4.type=="function"||S?b4.__d!==void 0?(e4=b4.__d,b4.__d=void 0):e4=g4.nextSibling:e4=$(n3,g4,e4):e4=C(b4,e4,n3),typeof u4.type=="function"&&(u4.__d=e4)));for(u4.__e=m3,p5=T2;p5--;)I2[p5]!=null&&(typeof u4.type=="function"&&I2[p5].__e!=null&&I2[p5].__e==u4.__d&&(u4.__d=I2[p5].__e.nextSibling),q(I2[p5],I2[p5]))}function C(n3,l5,u4){for(var t4,i4=n3.__k,o5=0;i4&&o5<i4.length;o5++)(t4=i4[o5])&&(t4.__=n3,l5=typeof t4.type=="function"?C(t4,l5,u4):$(u4,t4.__e,l5));return l5}function $(n3,l5,u4){return u4==null||u4.parentNode!==n3?n3.insertBefore(l5,null):l5==u4&&l5.parentNode!=null||n3.insertBefore(l5,u4),l5.nextSibling}function A(n3,l5,u4,t4){var i4=n3.key,o5=n3.type,r4=u4-1,f4=u4+1,e4=l5[u4];if(e4===null||e4&&i4==e4.key&&o5===e4.type)return u4;if(t4>(e4!=null?1:0))for(;r4>=0||f4<l5.length;){if(r4>=0){if((e4=l5[r4])&&i4==e4.key&&o5===e4.type)return r4;r4--}if(f4<l5.length){if((e4=l5[f4])&&i4==e4.key&&o5===e4.type)return f4;f4++}}return-1}function H(n3,l5,u4,t4,i4){var o5;for(o5 in u4)o5==="children"||o5==="key"||o5 in l5||T(n3,o5,null,u4[o5],t4);for(o5 in l5)i4&&typeof l5[o5]!="function"||o5==="children"||o5==="key"||o5==="value"||o5==="checked"||u4[o5]===l5[o5]||T(n3,o5,l5[o5],u4[o5],t4)}function I(n3,l5,u4){l5[0]==="-"?n3.setProperty(l5,u4??""):n3[l5]=u4==null?"":typeof u4!="number"||a.test(l5)?u4:u4+"px"}function T(n3,l5,u4,t4,i4){var o5;n:if(l5==="style")if(typeof u4=="string")n3.style.cssText=u4;else{if(typeof t4=="string"&&(n3.style.cssText=t4=""),t4)for(l5 in t4)u4&&l5 in u4||I(n3.style,l5,"");if(u4)for(l5 in u4)t4&&u4[l5]===t4[l5]||I(n3.style,l5,u4[l5])}else if(l5[0]==="o"&&l5[1]==="n")o5=l5!==(l5=l5.replace(/Capture$/,"")),l5=l5.toLowerCase()in n3?l5.toLowerCase().slice(2):l5.slice(2),n3.l||(n3.l={}),n3.l[l5+o5]=u4,u4?t4||n3.addEventListener(l5,o5?z:j,o5):n3.removeEventListener(l5,o5?z:j,o5);else if(l5!=="dangerouslySetInnerHTML"){if(i4)l5=l5.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(l5!=="width"&&l5!=="height"&&l5!=="href"&&l5!=="list"&&l5!=="form"&&l5!=="tabIndex"&&l5!=="download"&&l5!=="rowSpan"&&l5!=="colSpan"&&l5 in n3)try{n3[l5]=u4??"";break n}catch{}typeof u4=="function"||(u4==null||u4===!1&&l5[4]!=="-"?n3.removeAttribute(l5):n3.setAttribute(l5,u4))}}function j(n3){return this.l[n3.type+!1](l.event?l.event(n3):n3)}function z(n3){return this.l[n3.type+!0](l.event?l.event(n3):n3)}function L(n3,u4,t4,i4,o5,r4,f4,e4,c5,s4){var a4,p5,y3,d5,_4,g4,m3,w4,x2,C2,S,$2,A2,H2,I2,T2=u4.type;if(u4.constructor!==void 0)return null;t4.__h!=null&&(c5=t4.__h,e4=u4.__e=t4.__e,u4.__h=null,r4=[e4]),(a4=l.__b)&&a4(u4);try{n:if(typeof T2=="function"){if(w4=u4.props,x2=(a4=T2.contextType)&&i4[a4.__c],C2=a4?x2?x2.props.value:a4.__:i4,t4.__c?m3=(p5=u4.__c=t4.__c).__=p5.__E:("prototype"in T2&&T2.prototype.render?u4.__c=p5=new T2(w4,C2):(u4.__c=p5=new b(w4,C2),p5.constructor=T2,p5.render=B),x2&&x2.sub(p5),p5.props=w4,p5.state||(p5.state={}),p5.context=C2,p5.__n=i4,y3=p5.__d=!0,p5.__h=[],p5._sb=[]),p5.__s==null&&(p5.__s=p5.state),T2.getDerivedStateFromProps!=null&&(p5.__s==p5.state&&(p5.__s=v({},p5.__s)),v(p5.__s,T2.getDerivedStateFromProps(w4,p5.__s))),d5=p5.props,_4=p5.state,p5.__v=u4,y3)T2.getDerivedStateFromProps==null&&p5.componentWillMount!=null&&p5.componentWillMount(),p5.componentDidMount!=null&&p5.__h.push(p5.componentDidMount);else{if(T2.getDerivedStateFromProps==null&&w4!==d5&&p5.componentWillReceiveProps!=null&&p5.componentWillReceiveProps(w4,C2),!p5.__e&&(p5.shouldComponentUpdate!=null&&p5.shouldComponentUpdate(w4,p5.__s,C2)===!1||u4.__v===t4.__v)){for(u4.__v!==t4.__v&&(p5.props=w4,p5.state=p5.__s,p5.__d=!1),u4.__e=t4.__e,u4.__k=t4.__k,u4.__k.forEach(function(n4){n4&&(n4.__=u4)}),S=0;S<p5._sb.length;S++)p5.__h.push(p5._sb[S]);p5._sb=[],p5.__h.length&&f4.push(p5);break n}p5.componentWillUpdate!=null&&p5.componentWillUpdate(w4,p5.__s,C2),p5.componentDidUpdate!=null&&p5.__h.push(function(){p5.componentDidUpdate(d5,_4,g4)})}if(p5.context=C2,p5.props=w4,p5.__P=n3,p5.__e=!1,$2=l.__r,A2=0,"prototype"in T2&&T2.prototype.render){for(p5.state=p5.__s,p5.__d=!1,$2&&$2(u4),a4=p5.render(p5.props,p5.state,p5.context),H2=0;H2<p5._sb.length;H2++)p5.__h.push(p5._sb[H2]);p5._sb=[]}else do p5.__d=!1,$2&&$2(u4),a4=p5.render(p5.props,p5.state,p5.context),p5.state=p5.__s;while(p5.__d&&++A2<25);p5.state=p5.__s,p5.getChildContext!=null&&(i4=v(v({},i4),p5.getChildContext())),y3||p5.getSnapshotBeforeUpdate==null||(g4=p5.getSnapshotBeforeUpdate(d5,_4)),P(n3,h(I2=a4!=null&&a4.type===k&&a4.key==null?a4.props.children:a4)?I2:[I2],u4,t4,i4,o5,r4,f4,e4,c5,s4),p5.base=u4.__e,u4.__h=null,p5.__h.length&&f4.push(p5),m3&&(p5.__E=p5.__=null)}else r4==null&&u4.__v===t4.__v?(u4.__k=t4.__k,u4.__e=t4.__e):u4.__e=N(t4.__e,u4,t4,i4,o5,r4,f4,c5,s4);(a4=l.diffed)&&a4(u4)}catch(n4){u4.__v=null,(c5||r4!=null)&&(u4.__e=e4,u4.__h=!!c5,r4[r4.indexOf(e4)]=null),l.__e(n4,u4,t4)}}function M(n3,u4,t4){for(var i4=0;i4<t4.length;i4++)O(t4[i4],t4[++i4],t4[++i4]);l.__c&&l.__c(u4,n3),n3.some(function(u5){try{n3=u5.__h,u5.__h=[],n3.some(function(n4){n4.call(u5)})}catch(n4){l.__e(n4,u5.__v)}})}function N(l5,u4,t4,i4,o5,r4,f4,e4,s4){var a4,v5,y3,d5=t4.props,_4=u4.props,k3=u4.type,b4=0;if(k3==="svg"&&(o5=!0),r4!=null){for(;b4<r4.length;b4++)if((a4=r4[b4])&&"setAttribute"in a4==!!k3&&(k3?a4.localName===k3:a4.nodeType===3)){l5=a4,r4[b4]=null;break}}if(l5==null){if(k3===null)return document.createTextNode(_4);l5=o5?document.createElementNS("http://www.w3.org/2000/svg",k3):document.createElement(k3,_4.is&&_4),r4=null,e4=!1}if(k3===null)d5===_4||e4&&l5.data===_4||(l5.data=_4);else{if(r4=r4&&n.call(l5.childNodes),v5=(d5=t4.props||c).dangerouslySetInnerHTML,y3=_4.dangerouslySetInnerHTML,!e4){if(r4!=null)for(d5={},b4=0;b4<l5.attributes.length;b4++)d5[l5.attributes[b4].name]=l5.attributes[b4].value;(y3||v5)&&(y3&&(v5&&y3.__html==v5.__html||y3.__html===l5.innerHTML)||(l5.innerHTML=y3&&y3.__html||""))}if(H(l5,_4,d5,o5,e4),y3)u4.__k=[];else if(P(l5,h(b4=u4.props.children)?b4:[b4],u4,t4,i4,o5&&k3!=="foreignObject",r4,f4,r4?r4[0]:t4.__k&&g(t4,0),e4,s4),r4!=null)for(b4=r4.length;b4--;)r4[b4]!=null&&p(r4[b4]);e4||("value"in _4&&(b4=_4.value)!==void 0&&(b4!==l5.value||k3==="progress"&&!b4||k3==="option"&&b4!==d5.value)&&T(l5,"value",b4,d5.value,!1),"checked"in _4&&(b4=_4.checked)!==void 0&&b4!==l5.checked&&T(l5,"checked",b4,d5.checked,!1))}return l5}function O(n3,u4,t4){try{typeof n3=="function"?n3(u4):n3.current=u4}catch(n4){l.__e(n4,t4)}}function q(n3,u4,t4){var i4,o5;if(l.unmount&&l.unmount(n3),(i4=n3.ref)&&(i4.current&&i4.current!==n3.__e||O(i4,null,u4)),(i4=n3.__c)!=null){if(i4.componentWillUnmount)try{i4.componentWillUnmount()}catch(n4){l.__e(n4,u4)}i4.base=i4.__P=null,n3.__c=void 0}if(i4=n3.__k)for(o5=0;o5<i4.length;o5++)i4[o5]&&q(i4[o5],u4,t4||typeof n3.type!="function");t4||n3.__e==null||p(n3.__e),n3.__=n3.__e=n3.__d=void 0}function B(n3,l5,u4){return this.constructor(n3,u4)}function D(u4,t4,i4){var o5,r4,f4,e4;l.__&&l.__(u4,t4),r4=(o5=typeof i4=="function")?null:i4&&i4.__k||t4.__k,f4=[],e4=[],L(t4,u4=(!o5&&i4||t4).__k=y(k,null,[u4]),r4||c,c,t4.ownerSVGElement!==void 0,!o5&&i4?[i4]:r4?null:t4.firstChild?n.call(t4.childNodes):null,f4,!o5&&i4?i4:r4?r4.__e:t4.firstChild,o5,e4),M(f4,u4,e4)}n=s.slice,l={__e:function(n3,l5,u4,t4){for(var i4,o5,r4;l5=l5.__;)if((i4=l5.__c)&&!i4.__)try{if((o5=i4.constructor)&&o5.getDerivedStateFromError!=null&&(i4.setState(o5.getDerivedStateFromError(n3)),r4=i4.__d),i4.componentDidCatch!=null&&(i4.componentDidCatch(n3,t4||{}),r4=i4.__d),r4)return i4.__E=i4}catch(l6){n3=l6}throw n3}},u=0,t=function(n3){return n3!=null&&n3.constructor===void 0},b.prototype.setState=function(n3,l5){var u4;u4=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=v({},this.state),typeof n3=="function"&&(n3=n3(v({},u4),this.props)),n3&&v(u4,n3),n3!=null&&this.__v&&(l5&&this._sb.push(l5),w(this))},b.prototype.forceUpdate=function(n3){this.__v&&(this.__e=!0,n3&&this.__h.push(n3),w(this))},b.prototype.render=k,i=[],r=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,f=function(n3,l5){return n3.__v.__b-l5.__v.__b},x.__r=0,e=0;function functionArguments(function_){if(typeof function_!="function")throw new TypeError("Expected a function");let commentRegex=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,quotes=["`",'"',"'"],functionSource=function_.toString().replace(commentRegex,""),functionWithNoDefaults="",depth=0,index=0;for(;index<functionSource.length&&functionSource.charAt(index)!==")";index+=1){if(functionSource.startsWith("=>",index)){functionWithNoDefaults=functionSource,index=functionSource.length;break}if(functionSource.charAt(index)==="="){for(;index<functionSource.length&&(functionSource.charAt(index)!==","&&functionSource.charAt(index)!==")"||depth!==0);index+=1){let wasQuote=!1;for(let quote of quotes)if(functionSource.charAt(index)===quote){for(index+=1;index<functionSource.length&&functionSource.charAt(index)!==quote;)index+=1;wasQuote=!0;break}if(!wasQuote)switch(functionSource.charAt(index)){case"(":case"[":case"{":depth+=1;break;case")":case"]":case"}":depth-=1;break;default:}}if(functionSource.charAt(index)===","&&(functionWithNoDefaults+=","),functionSource.charAt(index)===")"){functionWithNoDefaults+=")";break}}else functionWithNoDefaults+=functionSource.charAt(index)}index<functionSource.length&&functionSource.charAt(index)===")"&&(functionWithNoDefaults+=")");let match=/^(?:async)?([^=()]+)=|\(([^)]+)\)/.exec(functionWithNoDefaults);return match?(match[1]||match[2]).split(",").map(x2=>x2.trim()).filter(Boolean):[]}var __assign=function(){return __assign=Object.assign||function(t4){for(var s4,i4=1,n3=arguments.length;i4<n3;i4++){s4=arguments[i4];for(var p5 in s4)Object.prototype.hasOwnProperty.call(s4,p5)&&(t4[p5]=s4[p5])}return t4},__assign.apply(this,arguments)};function lowerCase(str){return str.toLowerCase()}var DEFAULT_SPLIT_REGEXP=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],DEFAULT_STRIP_REGEXP=/[^A-Z0-9]+/gi;function noCase(input,options){options===void 0&&(options={});for(var _a=options.splitRegexp,splitRegexp=_a===void 0?DEFAULT_SPLIT_REGEXP:_a,_b=options.stripRegexp,stripRegexp=_b===void 0?DEFAULT_STRIP_REGEXP:_b,_c=options.transform,transform=_c===void 0?lowerCase:_c,_d=options.delimiter,delimiter=_d===void 0?" ":_d,result=replace(replace(input,splitRegexp,"$1\0$2"),stripRegexp,"\0"),start=0,end=result.length;result.charAt(start)==="\0";)start++;for(;result.charAt(end-1)==="\0";)end--;return result.slice(start,end).split("\0").map(transform).join(delimiter)}function replace(input,re,value){return re instanceof RegExp?input.replace(re,value):re.reduce(function(input2,re2){return input2.replace(re2,value)},input)}function dotCase(input,options){return options===void 0&&(options={}),noCase(input,__assign({delimiter:"."},options))}function paramCase(input,options){return options===void 0&&(options={}),dotCase(input,__assign({delimiter:"-"},options))}var IDX=256,HEX=[],SIZE=256,BUFFER;for(;IDX--;)HEX[IDX]=(IDX+256).toString(16).substring(1);function uid(len){var i4=0,tmp=len||11;if(!BUFFER||IDX+tmp>SIZE*2)for(BUFFER="",IDX=0;i4<SIZE;i4++)BUFFER+=HEX[Math.random()*256|0];return BUFFER.substring(IDX,IDX+++tmp)}function getAttributes(func){let args=functionArguments(func);return new Map(args.map(arg=>[paramCase(arg),arg]))}function getName(func){return paramCase(func.name)||"anonymous"}function getUniqueName(name){return name.includes("-")&&!window.customElements.get(name)?name:`${name}-${uid(5).toLowerCase()}`}function getArgumentValues(instance,attributes){return Object.fromEntries(Array.from(attributes.entries()).map(([attr,arg])=>{let value=instance.getAttribute(attr);return value=value===null?void 0:value,[arg,value]}))}function getFieldValues(instance,attributes,defaultArgs={}){return Object.fromEntries(Array.from(attributes.entries()).map(([,arg])=>{let value=instance[arg]??defaultArgs[arg];return value=value===null?void 0:value,[arg,value]}))}function decorateWithProps(Comp,attributes,privateFields,privateProps){attributes.forEach(arg=>{Object.defineProperty(Comp.prototype,arg,{get(){return privateFields.get(this)[arg]},set(value){privateFields.get(this)[arg]!==value&&(privateFields.get(this)[arg]=value,privateProps.get(this).self[$emit]())}})})}var $instance=Symbol("instance");function getInstance(self2){return self2[$instance]}var $emit=Symbol("emit"),AsyncGenerator=(async function*(){}).constructor;function isGeneratorFunction(func){return typeof func!="function"?!1:func instanceof AsyncGenerator}var ExportWrapper=class extends String{constructor(name,Comp){super(name),this.element=Comp}define(elementName,customElementRegistry=window.customElements,options=void 0){class Clone extends this.element{}customElementRegistry.define(elementName,Clone,options)}};var finishSymbol=Symbol("end");function mutationIterator(targetObj={},{yieldInit=!1,receiveEmitter=()=>{}}={}){let watcher,emitChange=()=>null;function emitter(){emitChange(!0),watch()}receiveEmitter(emitter);function watch(){watcher=new Promise(resolve=>{emitChange=resolve})}let result=new Proxy(targetObj,{set(target,prop,value){return target[prop]=value,emitChange(!0),watch(),!0},get(target,prop,receiver){return prop===Symbol.asyncIterator?async function*(){for(yieldInit&&(yield target);;){if(!await watcher)return target;yield target}}:prop===finishSymbol?()=>emitChange(!1):Reflect.get(target,prop,receiver)}});return watch(),result}function self(instance,attributes){let selfObj,defaultArgs;function base(localArgs){return defaultArgs=localArgs,selfObj}return base[$instance]=instance,Object.defineProperty(base,"props",{get(){return{...getFieldValues(instance,attributes,defaultArgs)}}}),Object.defineProperty(base,"children",{get(){return[...instance.childNodes]}}),selfObj=mutationIterator(base,{yieldInit:!0,receiveEmitter:emitter=>{base[$emit]=emitter}}),selfObj}function dispatchEvent(selfInstance,...args){let instance=getInstance(selfInstance);return instance.dispatchEvent.call(instance,...args)}function getDom(selfInstance){return getInstance(selfInstance).shadowRoot}function asWebComponent(func,renderer,{baseElement=void 0,baseClass=HTMLElement,effect=void 0}={}){let component=getName(func),name=getUniqueName(component),attributes=getAttributes(func),isGenerator=isGeneratorFunction(func),privateProps=new WeakMap,privateFields=new WeakMap;class Comp extends baseClass{constructor(){super(),privateProps.set(this,{}),privateFields.set(this,{}),this.attachShadow({mode:"open"}),privateProps.get(this).self=self(this,attributes),privateProps.get(this).componentFunc=func.bind(privateProps.get(this).self),privateProps.get(this).isFirstRender=!0}static get observedAttributes(){return Array.from(attributes.keys())}connectedCallback(){this.setAttribute("data-component",component);let args=getArgumentValues(this,attributes);Object.entries(args).forEach(([arg,value])=>{value&&(this[arg]=value)}),renderLoop.call(this)}attributeChangedCallback(attr,_4,newValue){let arg=attributes.get(attr);this[arg]=newValue}}async function renderLoop(){let{componentFunc}=privateProps.get(this);if(!isGenerator){for await(let _4 of privateProps.get(this).self){let fields2=getFieldValues(this,attributes),content=await componentFunc(...Object.values(fields2));renderer(content,this.shadowRoot)}return}let fields=getFieldValues(this,attributes);for await(let content of componentFunc(...Object.values(fields)))if(renderer(content,this.shadowRoot),privateProps.get(this).isFirstRender&&effect){privateProps.get(this).isFirstRender=!1;for(let prop in privateProps.get(this).self)typeof privateProps.get(this).self[prop]=="object"&&"value"in privateProps.get(this).self[prop]&&effect(()=>{let _4=privateProps.get(this).self[prop]?.value;privateProps.get(this).self[$emit]()})}}decorateWithProps(Comp,attributes,privateFields,privateProps);let exportWrapper=new ExportWrapper(name,Comp);return exportWrapper.define(name,void 0,baseElement?{extends:baseElement}:void 0),exportWrapper}var t2,r2,u2,i2,o2=0,f2=[],c2=[],e2=l.__b,a2=l.__r,v2=l.diffed,l2=l.__c,m2=l.unmount;function d2(t4,u4){l.__h&&l.__h(r2,t4,o2||u4),o2=0;var i4=r2.__H||(r2.__H={__:[],__h:[]});return t4>=i4.__.length&&i4.__.push({__V:c2}),i4.__[t4]}function F(n3,r4){var u4=d2(t2++,7);return z2(u4.__H,r4)?(u4.__V=n3(),u4.i=r4,u4.__h=n3,u4.__V):u4.__}function b2(){for(var t4;t4=f2.shift();)if(t4.__P&&t4.__H)try{t4.__H.__h.forEach(k2),t4.__H.__h.forEach(w2),t4.__H.__h=[]}catch(r4){t4.__H.__h=[],l.__e(r4,t4.__v)}}l.__b=function(n3){r2=null,e2&&e2(n3)},l.__r=function(n3){a2&&a2(n3),t2=0;var i4=(r2=n3.__c).__H;i4&&(u2===r2?(i4.__h=[],r2.__h=[],i4.__.forEach(function(n4){n4.__N&&(n4.__=n4.__N),n4.__V=c2,n4.__N=n4.i=void 0})):(i4.__h.forEach(k2),i4.__h.forEach(w2),i4.__h=[],t2=0)),u2=r2},l.diffed=function(t4){v2&&v2(t4);var o5=t4.__c;o5&&o5.__H&&(o5.__H.__h.length&&(f2.push(o5)!==1&&i2===l.requestAnimationFrame||((i2=l.requestAnimationFrame)||j2)(b2)),o5.__H.__.forEach(function(n3){n3.i&&(n3.__H=n3.i),n3.__V!==c2&&(n3.__=n3.__V),n3.i=void 0,n3.__V=c2})),u2=r2=null},l.__c=function(t4,r4){r4.some(function(t5){try{t5.__h.forEach(k2),t5.__h=t5.__h.filter(function(n3){return!n3.__||w2(n3)})}catch(u4){r4.some(function(n3){n3.__h&&(n3.__h=[])}),r4=[],l.__e(u4,t5.__v)}}),l2&&l2(t4,r4)},l.unmount=function(t4){m2&&m2(t4);var r4,u4=t4.__c;u4&&u4.__H&&(u4.__H.__.forEach(function(n3){try{k2(n3)}catch(n4){r4=n4}}),u4.__H=void 0,r4&&l.__e(r4,u4.__v))};var g2=typeof requestAnimationFrame=="function";function j2(n3){var t4,r4=function(){clearTimeout(u4),g2&&cancelAnimationFrame(t4),setTimeout(n3)},u4=setTimeout(r4,100);g2&&(t4=requestAnimationFrame(r4))}function k2(n3){var t4=r2,u4=n3.__c;typeof u4=="function"&&(n3.__c=void 0,u4()),r2=t4}function w2(n3){var t4=r2;n3.__c=n3.__(),r2=t4}function z2(n3,t4){return!n3||n3.length!==t4.length||t4.some(function(t5,r4){return t5!==n3[r4]})}function i3(){throw new Error("Cycle detected")}function t3(){if(h2>1)h2--;else{for(var i4,t4=!1;n2!==void 0;){var o5=n2;for(n2=void 0,s2++;o5!==void 0;){var r4=o5.o;if(o5.o=void 0,o5.f&=-3,!(8&o5.f)&&c3(o5))try{o5.c()}catch(o6){t4||(i4=o6,t4=!0)}o5=r4}}if(s2=0,h2--,t4)throw i4}}var r3=void 0,n2=void 0,h2=0,s2=0,f3=0;function v3(i4){if(r3!==void 0){var t4=i4.n;if(t4===void 0||t4.t!==r3)return t4={i:0,S:i4,p:r3.s,n:void 0,t:r3,e:void 0,x:void 0,r:t4},r3.s!==void 0&&(r3.s.n=t4),r3.s=t4,i4.n=t4,32&r3.f&&i4.S(t4),t4;if(t4.i===-1)return t4.i=0,t4.n!==void 0&&(t4.n.p=t4.p,t4.p!==void 0&&(t4.p.n=t4.n),t4.p=r3.s,t4.n=void 0,r3.s.n=t4,r3.s=t4),t4}}function e3(i4){this.v=i4,this.i=0,this.n=void 0,this.t=void 0}e3.prototype.h=function(){return!0};e3.prototype.S=function(i4){this.t!==i4&&i4.e===void 0&&(i4.x=this.t,this.t!==void 0&&(this.t.e=i4),this.t=i4)};e3.prototype.U=function(i4){if(this.t!==void 0){var t4=i4.e,o5=i4.x;t4!==void 0&&(t4.x=o5,i4.e=void 0),o5!==void 0&&(o5.e=t4,i4.x=void 0),i4===this.t&&(this.t=o5)}};e3.prototype.subscribe=function(i4){var t4=this;return b3(function(){var o5=t4.value,r4=32&this.f;this.f&=-33;try{i4(o5)}finally{this.f|=r4}})};e3.prototype.valueOf=function(){return this.value};e3.prototype.toString=function(){return this.value+""};e3.prototype.toJSON=function(){return this.value};e3.prototype.peek=function(){return this.v};Object.defineProperty(e3.prototype,"value",{get:function(){var i4=v3(this);return i4!==void 0&&(i4.i=this.i),this.v},set:function(o5){if(r3 instanceof l3&&function(){throw new Error("Computed cannot have side-effects")}(),o5!==this.v){s2>100&&i3(),this.v=o5,this.i++,f3++,h2++;try{for(var n3=this.t;n3!==void 0;n3=n3.x)n3.t.N()}finally{t3()}}}});function u3(i4){return new e3(i4)}function c3(i4){for(var t4=i4.s;t4!==void 0;t4=t4.n)if(t4.S.i!==t4.i||!t4.S.h()||t4.S.i!==t4.i)return!0;return!1}function d3(i4){for(var t4=i4.s;t4!==void 0;t4=t4.n){var o5=t4.S.n;if(o5!==void 0&&(t4.r=o5),t4.S.n=t4,t4.i=-1,t4.n===void 0){i4.s=t4;break}}}function a3(i4){for(var t4=i4.s,o5=void 0;t4!==void 0;){var r4=t4.p;t4.i===-1?(t4.S.U(t4),r4!==void 0&&(r4.n=t4.n),t4.n!==void 0&&(t4.n.p=r4)):o5=t4,t4.S.n=t4.r,t4.r!==void 0&&(t4.r=void 0),t4=r4}i4.s=o5}function l3(i4){e3.call(this,void 0),this.x=i4,this.s=void 0,this.g=f3-1,this.f=4}(l3.prototype=new e3).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===f3))return!0;if(this.g=f3,this.f|=1,this.i>0&&!c3(this))return this.f&=-2,!0;var i4=r3;try{d3(this),r3=this;var t4=this.x();(16&this.f||this.v!==t4||this.i===0)&&(this.v=t4,this.f&=-17,this.i++)}catch(i5){this.v=i5,this.f|=16,this.i++}return r3=i4,a3(this),this.f&=-2,!0};l3.prototype.S=function(i4){if(this.t===void 0){this.f|=36;for(var t4=this.s;t4!==void 0;t4=t4.n)t4.S.S(t4)}e3.prototype.S.call(this,i4)};l3.prototype.U=function(i4){if(this.t!==void 0&&(e3.prototype.U.call(this,i4),this.t===void 0)){this.f&=-33;for(var t4=this.s;t4!==void 0;t4=t4.n)t4.S.U(t4)}};l3.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var i4=this.t;i4!==void 0;i4=i4.x)i4.t.N()}};l3.prototype.peek=function(){if(this.h()||i3(),16&this.f)throw this.v;return this.v};Object.defineProperty(l3.prototype,"value",{get:function(){1&this.f&&i3();var t4=v3(this);if(this.h(),t4!==void 0&&(t4.i=this.i),16&this.f)throw this.v;return this.v}});function w3(i4){return new l3(i4)}function y2(i4){var o5=i4.u;if(i4.u=void 0,typeof o5=="function"){h2++;var n3=r3;r3=void 0;try{o5()}catch(t4){throw i4.f&=-2,i4.f|=8,_(i4),t4}finally{r3=n3,t3()}}}function _(i4){for(var t4=i4.s;t4!==void 0;t4=t4.n)t4.S.U(t4);i4.x=void 0,i4.s=void 0,y2(i4)}function p2(i4){if(r3!==this)throw new Error("Out-of-order effect");a3(this),r3=i4,this.f&=-2,8&this.f&&_(this),t3()}function g3(i4){this.x=i4,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}g3.prototype.c=function(){var i4=this.S();try{if(8&this.f||this.x===void 0)return;var t4=this.x();typeof t4=="function"&&(this.u=t4)}finally{i4()}};g3.prototype.S=function(){1&this.f&&i3(),this.f|=1,this.f&=-9,y2(this),d3(this),h2++;var t4=r3;return r3=this,p2.bind(this,t4)};g3.prototype.N=function(){2&this.f||(this.f|=2,this.o=n2,n2=this)};g3.prototype.d=function(){this.f|=8,1&this.f||_(this)};function b3(i4){var t4=new g3(i4);try{t4.c()}catch(i5){throw t4.d(),i5}return t4.d.bind(t4)}var c4,v4;function s3(n3,i4){l[n3]=i4.bind(null,l[n3]||function(){})}function l4(n3){v4&&v4(),v4=n3&&n3.S()}function d4(n3){var r4=this,t4=n3.data,f4=useSignal(t4);f4.value=t4;var o5=F(function(){for(var n4=r4.__v;n4=n4.__;)if(n4.__c){n4.__c.__$f|=4;break}return r4.__$u.c=function(){r4.base.data=o5.peek()},w3(function(){var n5=f4.value.value;return n5===0?0:n5===!0?"":n5||""})},[]);return o5.value}d4.displayName="_st";Object.defineProperties(e3.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:d4},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});s3("__b",function(n3,r4){if(typeof r4.type=="string"){var i4,t4=r4.props;for(var f4 in t4)if(f4!=="children"){var e4=t4[f4];e4 instanceof e3&&(i4||(r4.__np=i4={}),i4[f4]=e4,t4[f4]=e4.peek())}}n3(r4)});s3("__r",function(n3,r4){l4();var i4,t4=r4.__c;t4&&(t4.__$f&=-2,(i4=t4.__$u)===void 0&&(t4.__$u=i4=function(n4){var r5;return b3(function(){r5=this}),r5.c=function(){t4.__$f|=1,t4.setState({})},r5}())),c4=t4,l4(i4),n3(r4)});s3("__e",function(n3,r4,i4,t4){l4(),c4=void 0,n3(r4,i4,t4)});s3("diffed",function(n3,r4){l4(),c4=void 0;var i4;if(typeof r4.type=="string"&&(i4=r4.__e)){var t4=r4.__np,f4=r4.props;if(t4){var o5=i4.U;if(o5)for(var e4 in o5){var u4=o5[e4];u4!==void 0&&!(e4 in t4)&&(u4.d(),o5[e4]=void 0)}else i4.U=o5={};for(var a4 in t4){var v5=o5[a4],s4=t4[a4];v5===void 0?(v5=p4(i4,a4,s4,f4),o5[a4]=v5):v5.o(s4,f4)}}}n3(r4)});function p4(n3,r4,i4,t4){var f4=r4 in n3&&n3.ownerSVGElement===void 0,o5=u3(i4);return{o:function(n4,r5){o5.value=n4,t4=r5},d:b3(function(){var i5=o5.value.value;t4[r4]!==i5&&(t4[r4]=i5,f4?n3[r4]=i5:i5?n3.setAttribute(r4,i5):n3.removeAttribute(r4))})}}s3("unmount",function(n3,r4){if(typeof r4.type=="string"){var i4=r4.__e;if(i4){var t4=i4.U;if(t4){i4.U=void 0;for(var f4 in t4){var o5=t4[f4];o5&&o5.d()}}}}else{var e4=r4.__c;if(e4){var u4=e4.__$u;u4&&(e4.__$u=void 0,u4.d())}}n3(r4)});s3("__h",function(n3,r4,i4,t4){(t4<3||t4===9)&&(r4.__$f|=2),n3(r4,i4,t4)});b.prototype.shouldComponentUpdate=function(n3,r4){var i4=this.__$u;if(!(i4&&i4.s!==void 0||4&this.__$f)||3&this.__$f)return!0;for(var t4 in r4)return!0;for(var f4 in n3)if(f4!=="__source"&&n3[f4]!==this.props[f4])return!0;for(var o5 in this.props)if(!(o5 in n3))return!0;return!1};function useSignal(n3){return F(function(){return u3(n3)},[])}var screenLockDisabled=u3(!1);async function disableScreenLock(){try{console.log("Requesting WakeLock"),await navigator.wakeLock.request("screen"),screenLockDisabled.value=!0}catch(error){console.error("WakeLock",error),screenLockDisabled.value=!1}}var _3=0;function o4(o5,e4,n3,t4,f4,l5){var s4,u4,a4={};for(u4 in e4)u4=="ref"?s4=e4[u4]:a4[u4]=e4[u4];var i4={type:o5,props:a4,key:n3,ref:s4,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--_3,__source:f4,__self:l5};if(typeof o5=="function"&&(s4=o5.defaultProps))for(u4 in s4)a4[u4]===void 0&&(a4[u4]=s4[u4]);return l.vnode&&l.vnode(i4),i4}async function*WakeLock(){this.wakeLockDisabled=screenLockDisabled;for await(let{wakeLockDisabled}of this)yield o4(k,{children:[o4("link",{rel:"stylesheet",href:"/dist/main.css"}),o4("span",{children:"\u{1F505}"}),!wakeLockDisabled.value&&o4("span",{children:"\u{1F6AB}"})]})}var WakeLock_default=asWebComponent(WakeLock,D,{effect:b3});var package_default={name:"remote-control",version:"1.3.1",description:"BLE Remote Control",main:"src/index.html",directories:{doc:"docs"},scripts:{test:"npm run lint && npm run build",start:"esbuild src/main.js --bundle --outdir=public/dist --jsx-import-source=preact --jsx=automatic --target=safari16 --watch --servedir=public --sourcemap",build:"esbuild src/main.js --bundle --outdir=dist/dist --jsx-import-source=preact --jsx=automatic --target=safari16 --minify-whitespace --minify-syntax && cp -r public/. dist/",lint:"eslint src",deploy:"gh-pages -d dist"},repository:{type:"git",url:"git+https://github.com/DavidBeale/remote-control.git"},author:"David Beale",license:"MIT",bugs:{url:"https://github.com/DavidBeale/remote-control/issues"},homepage:"https://github.com/DavidBeale/remote-control#readme",devDependencies:{"browser-sync":"^2.27.9",esbuild:"^0.18.16",eslint:"^8.45.0","eslint-config-airbnb":"^19.0.4","eslint-config-prettier":"^8.8.0","eslint-plugin-prettier":"^5.0.0","gh-pages":"^5.0.0"},dependencies:{"@picocss/pico":"^2.0.0-alpha1","@preact/signals":"^1.1.5","as-web-component":"^0.6.2",multirator:"^0.1.0",preact:"^10.16.0"}};function Header(){return o4(k,{children:[o4("link",{rel:"stylesheet",href:"/dist/main.css"}),o4("header",{children:[o4("h1",{children:["BLE Remote Control (",package_default.version,")"]}),o4(WakeLock_default,{})]})]})}var Header_default=asWebComponent(Header,D);async function DeviceSelector(devices,currentDeviceName){let select=name=>{dispatchEvent(this,new CustomEvent("change",{detail:{name}}))},menuSelect=event=>{dispatchEvent(this,new CustomEvent("Menu",{detail:event.target.value})),event.target.value=""};return o4(k,{children:[o4("link",{rel:"stylesheet",href:"/dist/main.css"}),o4("nav",{children:[o4("div",{role:"group",children:devices.map(name=>name===currentDeviceName?o4("button",{"aria-current":"true",children:name}):o4("button",{class:"secondary",onClick:()=>select(name),children:name}))}),o4("select",{onChange:menuSelect,value:"",children:[o4("option",{value:"",disabled:!0,children:"..."}),o4("option",{children:"Add Device"}),o4("option",{children:"Disconnect"})]})]})]})}var DeviceSelector_default=asWebComponent(DeviceSelector,D);var FeatureMap_default={"0000000a-0000-1000-8000-00805f9b34fb":{name:"engine",label:"Engine"},"0000000b-0000-1000-8000-00805f9b34fb":{name:"headlight",label:"Head Light"},"0000000c-0000-1000-8000-00805f9b34fb":{name:"cablight",label:"Cab Light"},"0000000d-0000-1000-8000-00805f9b34fb":{name:"velocity"},"0000000e-0000-1000-8000-00805f9b34fb":{name:"speed"}};async function*SwitchFeature(feature){this.checked=!1;let checked=event=>{event.target.checked?this.props.feature.writeValue(Uint8Array.from([1])):this.props.feature.writeValue(Uint8Array.from([0]))};for await(let{props}of this(feature))this.checked=(await props.feature.readValue()).getUint8(),props.feature.value.map(value=>(this.checked=value.getUint8(),null)),yield o4(k,{children:[o4("link",{rel:"stylesheet",href:"/dist/main.css"}),o4("label",{children:[o4("input",{type:"checkbox",role:"switch",checked:this.checked,onChange:checked}),FeatureMap_default[props.feature.uuid].label]})]})}var SwitchFeature_default=asWebComponent(SwitchFeature,D);var RangeSlider=class{constructor(element,settings){this.settings={clsCircular:"c-rng--circular",clsCircularOutput:"c-rng--circular-output",clsOutput:"c-rng__output",clsOutputWrapper:"c-rng--output",clsRangeTicks:"c-rng--ticks",clsWrapper:"c-rng__wrapper",offset:-90,varPercent:"--rng-percent",varPercentUpper:"--rng-percent-upper",varThumb:"--rng-thumb-w",varUnit:"--rng-unit",varValue:"--rng-value",...stringToType(settings)},this.range=element,this.initRange(this.range)}initRange(range){let circular=this.settings.range.includes("circular");range.id=range.id||uuid(),this.lower=this.settings.range.includes("upper")?range.parentNode.querySelector('[data-range*="lower"]'):null,this.max=parseInt(range.max,10)||100,this.min=parseInt(range.min,10),this.multiplier=100/(this.max-this.min),this.output=this.settings.range.includes("output")||circular?document.createElement("output"):null,this.ticks=parseInt(range.dataset.ticks,10),this.upper=this.settings.range.includes("lower")?range.parentNode.querySelector('[data-range*="upper"]'):null;let isMulti=this.lower||this.upper;if(this.wrapper=isMulti?range.parentNode:document.createElement("div"),this.output&&(this.output.className=circular?this.settings.clsCircularOutput:this.settings.clsOutput,this.output.for=range.id,isMulti?this.wrapper.insertBefore(this.output,range):(this.wrapper.classList.add(circular?this.settings.clsCircular:this.settings.clsOutputWrapper),this.wrapper.appendChild(this.output))),isMulti||(range.parentNode.insertBefore(this.wrapper,range),this.wrapper.appendChild(range)),range.dataset.modifier&&this.wrapper.classList.add(range.dataset.modifier),this.wrapper.classList.add(this.settings.clsWrapper),this.wrapper.style.setProperty(this.settings.varThumb,getComputedStyle(range).getPropertyValue(this.settings.varThumb)),this.ticks){let ticks=[...Array(this.ticks).keys()],svg=`
          <svg class="${this.settings.clsRangeTicks}" width="100%" height="100%">
          ${ticks.map(index=>`<rect x="${100/this.ticks*index}%" y="5" width="1" height="100%"></rect>`).join("")}
          <rect x="100%" y="5" width="1" height="100%"></rect>
        </svg>`;this.wrapper.insertAdjacentHTML("afterbegin",svg)}if(circular){range.hidden=!0;let pointerMove=event=>this.updateCircle(this.rotate(event.pageX,event.pageY));this.setCenter(),this.output.setAttribute("tabindex",0),this.output.addEventListener("keydown",event=>{switch(event.key){case"ArrowLeft":case"ArrowDown":event.preventDefault(),this.range.stepDown(),this.updateCircle();break;case"ArrowRight":case"ArrowUp":event.preventDefault(),this.range.stepUp(),this.updateCircle();break;default:break}}),this.output.addEventListener("pointerdown",()=>this.output.addEventListener("pointermove",pointerMove)),this.output.addEventListener("pointerup",()=>this.output.removeEventListener("pointermove",pointerMove)),range.addEventListener("input",()=>this.updateCircle(0)),this.updateCircle()}else range.addEventListener("input",()=>this.updateRange());range.dispatchEvent(new Event("input"))}rotate(x2,y3){return Math.atan2(y3-this.center.y,x2-this.center.x)*180/Math.PI}setCenter(){let rect=this.wrapper.getBoundingClientRect();this.center={x:rect.left+rect.width/2,y:rect.top+rect.height/2}}updateCircle(start){let angle=start,rad=360/(this.max-this.min);angle||(angle=rad*this.range.valueAsNumber+this.settings.offset);let end=angle-this.settings.offset;end<0&&(end+=360);let value=Math.ceil(end/rad);value>this.range.max||value<this.range.min||(this.range.value=value,this.range.dispatchEvent(new Event("change",{bubbles:!0})),this.wrapper.dataset.value=this.range.value,this.wrapper.style.setProperty("--angle",`${angle}deg`),this.wrapper.style.setProperty("--gradient-end",`${end}deg`))}updateRange(){if(this.lower&&this.lower.valueAsNumber>this.range.valueAsNumber){this.range.value=this.lower.valueAsNumber,this.range.dispatchEvent(new Event("input",{bubbles:!0}));return}if(this.upper&&this.upper.valueAsNumber<this.range.valueAsNumber){this.range.value=this.upper.valueAsNumber,this.range.dispatchEvent(new Event("input",{bubbles:!0}));return}let value=(this.range.valueAsNumber-this.min)*this.multiplier;this.range.style.setProperty(this.settings.varPercent,`${value}%`),this.range.style.setProperty(this.settings.varValue,`${this.range.valueAsNumber}`),this.lower&&this.lower.style.setProperty(this.settings.varPercentUpper,`${value}%`),this.output&&(this.output.style.setProperty(this.settings.varUnit,`${value}`),this.output.innerText=this.range.value)}};function stringToType(obj){let object={...obj};return Object.keys(object).forEach(key=>{typeof object[key]=="string"&&object[key].charAt(0)===":"&&(object[key]=JSON.parse(object[key].slice(1)))}),object}function uuid(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,c5=>(c5^crypto.getRandomValues(new Uint8Array(1))[0]&15>>c5/4).toString(16))}async function*Throttle(speed=0){yield o4(k,{children:[o4("link",{rel:"stylesheet",href:"/dist/main.css"}),o4("input",{type:"range",value:speed,onChange:event=>dispatchEvent(this,new CustomEvent("change",{detail:event.target.valueAsNumber})),min:"0",max:"100",step:"5"}),o4("button",{id:"stop",onClick:()=>dispatchEvent(this,new CustomEvent("change",{detail:0})),children:"Stop"})]});let range=getDom(this).querySelector("input");new RangeSlider(range,{range:"circular"});for await(let{props}of this({speed}))range.value=props.speed,range.dispatchEvent(new Event("input"))}var Throttle_default=asWebComponent(Throttle,D);async function Direction(gear,gears={},disabled=!1,step=1){let gearEntries=Object.entries(gears),min=Math.min(...gearEntries.map(([,value])=>value)),max=Math.max(...gearEntries.map(([,value])=>value));return o4(k,{children:[o4("link",{rel:"stylesheet",href:"/dist/main.css"}),o4("input",{type:"range",value:gear,disabled,onChange:event=>dispatchEvent(this,new CustomEvent("change",{detail:event.target.valueAsNumber})),min,max,step,list:"markers"}),o4("datalist",{id:"markers",children:gearEntries.map(([label,value])=>o4("option",{value,children:label}))})]})}var Gear_default=asWebComponent(Direction,D);function throttle(func,delay){let lastCall=0;return function(...args){let now=new Date().getTime();now-lastCall<delay||(lastCall=now,func(...args))}}async function*VelocityFeature(feature){this.speed=0,this.direction=1;let changeSpeed=throttle(event=>{this.speed=event.detail,this.props.feature.writeValue(Int8Array.from([this.speed*this.direction]))},100),changeDirection=event=>{this.direction=event.detail,this.props.feature.writeValue(Int8Array.from([this.speed*this.direction]))};[this.speed,this.direction]=splitValues(await feature.readValue());for await(let{props}of this(feature)){props.feature.value.map(value=>([this.speed,this.direction]=splitValues(value),null));let directionDisabled=this.speed!==0;yield o4("article",{children:[o4("link",{rel:"stylesheet",href:"/dist/main.css"}),o4(Gear_default,{gear:this.direction,gears:{Reverse:-1,Forward:1},step:2,disabled:directionDisabled,onChange:changeDirection}),o4(Throttle_default,{speed:this.speed,onChange:changeSpeed})]})}}var VelocityFeature_default=asWebComponent(VelocityFeature,D);function splitValues(value){let velocity=value.getInt8(0),speed=Math.abs(velocity),direction=1;return velocity<0&&(direction=-1),[speed,direction]}async function Controls(service){let{features}=service,velocity=features.find(feature=>FeatureMap_default[feature.uuid]?.name==="velocity");return o4("section",{children:[o4("link",{rel:"stylesheet",href:"/dist/main.css"}),o4("article",{children:o4("fieldset",{children:features.filter(feature=>FeatureMap_default[feature.uuid].label).map(feature=>o4(SwitchFeature_default,{feature}))})}),velocity&&o4(VelocityFeature_default,{feature:velocity})]})}var Controls_default=asWebComponent(Controls,D);var Iterator=class _Iterator{constructor(iterator){this[Symbol.asyncIterator]=async function*(){for await(let value of iterator)yield value}}filter(func){return new _Iterator(filter(this,func))}map(func){return new _Iterator(map(this,func))}concat(iterator){return new _Iterator(concat(this,iterator))}async forEach(func){for await(let value of this)func(value)}async reduce(func,initValue){let acc=initValue;for await(let value of this)acc===void 0?acc=value:acc=func(acc,value);return acc}};async function*filter(iterator,func){for await(let value of iterator)func(value)&&(yield value)}async function*map(iterator,func){for await(let value of iterator)yield func(value)}async function*concat(iterator1,iterator2){for await(let value of iterator1)yield value;for await(let value of iterator2)yield value}var Multirator=class extends Iterator{constructor(iterator){super(iterator);let done=!1,value,resolver,rejector,pending2=new Promise((resolve,reject)=>{resolver=resolve,rejector=reject});(async()=>{for(;!done;)try{let result=await iterator.next();done=result.done,value=result.value,resolver(result)}catch(error){rejector(error)}finally{pending2=new Promise((resolve,reject)=>{resolver=resolve,rejector=reject})}})(),this[Symbol.asyncIterator]=async function*(){for(!done&&value!==void 0&&(yield value);!done;)await pending2,done||(yield value)}}};var pending=Promise.resolve();function enqueue(func){return pending=run(func)}async function run(func){try{await pending}finally{return func()}}var TRAIN_SERVICE_UUID="e4580f53-0298-41fa-8210-ce8f8bbe23a3",TrainService=class _TrainService{constructor(deviceName){this.deviceName=deviceName,this.device=void 0,this.primaryService=void 0,this.featureMap={},this.isConnected=u3(!1)}static async select(name){_TrainService.selectOpen.value=!0;try{return await navigator.bluetooth.requestDevice({filters:name?[{name}]:[{services:[TRAIN_SERVICE_UUID]},{services:["6e400001-b5a3-f393-e0a9-e50e24dcca9e"]}]})}finally{_TrainService.selectOpen.value=!1}}static selectOpen=u3(!1);get features(){return Object.values(this.featureMap)}async connect(device){this.device=device,console.log("Connecting to device",this.device?.name);try{await this.device.gatt.connect(),console.log("Connected to device",this.device?.name),this.primaryService=await this.device.gatt.getPrimaryService(TRAIN_SERVICE_UUID),this.device.addEventListener("gattserverdisconnected",reConnect.bind(this)),await loadFeatures.call(this),this.isConnected.value=!0}catch(error){console.error("Failed to connect to Device"),console.error(error.stack??error),console.log("Retrying in 3secs"),this.isConnected.value=!1,setTimeout(async()=>{let newDevice=await _TrainService.select(this.device.name);this.connect(newDevice)},3e3)}}disconnect(){this.device&&(this.device.removeEventListener("gattserverdisconnected",reConnect),this.isConnected.value=!1,this.device.gatt.disconnect())}};function reConnect(){this.isConnected.value&&(console.log("Disconnected from device",this.device?.name??"Unknown"),this.connect(this.device))}async function loadFeatures(){let features=await this.primaryService.getCharacteristics();for(let feature of features)this.featureMap[feature.uuid]||(this.featureMap[feature.uuid]={uuid:feature.uuid},this.featureMap[feature.uuid].value=new Multirator((async function*(){for(feature.value&&(yield feature.value);;)yield new Promise(resolve=>{this.featureMap[feature.uuid].resolver=resolve})}).call(this))),this.featureMap[feature.uuid].writeValue=value=>enqueue(()=>feature.writeValue.call(feature,value)),this.featureMap[feature.uuid].readValue=()=>enqueue(()=>feature.readValue.call(feature)),feature.addEventListener("characteristicvaluechanged",async()=>{this.featureMap[feature.uuid]?.resolver(feature.value)}),feature.startNotifications(),this.featureMap[feature.uuid].readValue().then(()=>{this.featureMap[feature.uuid]?.resolver(feature.value)})}async function Connect(service){return o4("section",{children:[o4("link",{rel:"stylesheet",href:"/dist/main.css"}),o4("button",{onClick:async()=>{disableScreenLock();let device=await TrainService.select();service.connect(device)},children:"Connect"})]})}var Connect_default=asWebComponent(Connect,D);var trackPath=describeArc(150,150,150,150-30,-150,150);function Dial(value=0){let angle=3*value-150;return o4(k,{children:[o4("link",{rel:"stylesheet",href:"/dist/main.css"}),o4("svg",{width:"300",height:"300",children:[o4("path",{id:"track",d:trackPath}),o4("path",{id:"thumb",d:describeArc(150,150,150,150-30,-150,angle)})]})]})}var Dial_default=asWebComponent(Dial,D);function describeArc(x2,y3,innerRadius,outerRadius,startAngle,endAngle){let radius=innerRadius,spread=outerRadius-innerRadius,innerStart=polarToCartesian(x2,y3,radius,endAngle),innerEnd=polarToCartesian(x2,y3,radius,startAngle),outerStart=polarToCartesian(x2,y3,radius+spread,endAngle),outerEnd=polarToCartesian(x2,y3,radius+spread,startAngle),largeArcFlag=endAngle-startAngle<=180?"0":"1";return["M",outerStart.x,outerStart.y,"A",radius+spread,radius+spread,0,largeArcFlag,0,outerEnd.x,outerEnd.y,"L",innerEnd.x,innerEnd.y,"A",radius,radius,0,largeArcFlag,1,innerStart.x,innerStart.y,"L",outerStart.x,outerStart.y,"Z"].join(" ")}function polarToCartesian(centerX,centerY,radius,angleInDegrees){let angleInRadians=(angleInDegrees-90)*Math.PI/180;return{x:centerX+radius*Math.cos(angleInRadians),y:centerY+radius*Math.sin(angleInRadians)}}async function*RemoteControl(){let knownDevices=["Star","Jessie","Greendale Rocket"],deviceToServiceMap=Object.fromEntries(knownDevices.map(name=>[name,new TrainService(name)]));this.status=w3(()=>Object.entries(deviceToServiceMap).map(([,service])=>service.isConnected.value)),[this.currentDeviceName=""]=knownDevices,this.selectOpen=TrainService.selectOpen;let changeDevice=name=>{this.currentDeviceName=name},menuSelected=option=>{switch(option){case"Disconnect":{deviceToServiceMap[this.currentDeviceName].disconnect();break}}};for await(let{currentDeviceName,selectOpen}of this){let service=deviceToServiceMap[currentDeviceName];yield o4(k,{children:[o4("link",{rel:"stylesheet",href:"/dist/main.css"}),o4("style",{children:`
           :host {
            ${selectOpen.value?"opacity: 10%; pointer-events: none;":""}
           }
          `}),o4(Header_default,{}),o4("main",{class:"container-fluid",children:[o4(DeviceSelector_default,{devices:knownDevices,currentDeviceName,onChange:event=>changeDevice(event.detail.name),onMenu:event=>menuSelected(event.detail)}),service.isConnected.value?o4(Controls_default,{service}):o4(Connect_default,{service})]})]})}}var RemoteControl_default=asWebComponent(RemoteControl,D,{effect:b3});window.location.hostname==="localhost"&&new EventSource("/esbuild").addEventListener("change",()=>window.location.reload());})();
